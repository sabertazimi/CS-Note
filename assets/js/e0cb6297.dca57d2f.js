"use strict";(self.webpackChunkawesome_notes=self.webpackChunkawesome_notes||[]).push([[8747],{1580:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"Web/JavaScript/JavaScriptPerformanceNotes","title":"JavaScript Performance Notes","description":"Effective JavaScript","source":"@site/notes/Web/JavaScript/JavaScriptPerformanceNotes.md","sourceDirName":"Web/JavaScript","slug":"/Web/JavaScript/JavaScriptPerformanceNotes","permalink":"/awesome-notes/Web/JavaScript/JavaScriptPerformanceNotes","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/awesome-notes/edit/main/notes/Web/JavaScript/JavaScriptPerformanceNotes.md","tags":[{"inline":true,"label":"Web","permalink":"/awesome-notes/tags/web"},{"inline":true,"label":"JavaScript","permalink":"/awesome-notes/tags/java-script"},{"inline":true,"label":"ECMAScript","permalink":"/awesome-notes/tags/ecma-script"},{"inline":true,"label":"Performance","permalink":"/awesome-notes/tags/performance"}],"version":"current","lastUpdatedBy":"renovate[bot]","lastUpdatedAt":1732127335000,"frontMatter":{"author":"Sabertazimi","authorTitle":"Web Developer","authorURL":"https://github.com/sabertazimi","authorImageURL":"https://github.com/sabertazimi.png","tags":["Web","JavaScript","ECMAScript","Performance"]},"sidebar":"tutorialSidebar","previous":{"title":"JavaScript DevOps Notes","permalink":"/awesome-notes/Web/JavaScript/JavaScriptDevOpsNotes"},"next":{"title":"JavaScript Testing Notes","permalink":"/awesome-notes/Web/JavaScript/JavaScriptTestingNotes"}}');var r=i(5105),t=i(842);const l={author:"Sabertazimi",authorTitle:"Web Developer",authorURL:"https://github.com/sabertazimi",authorImageURL:"https://github.com/sabertazimi.png",tags:["Web","JavaScript","ECMAScript","Performance"]},c="JavaScript Performance Notes",a={},d=[{value:"Effective JavaScript",id:"effective-javascript",level:2},{value:"Memory Leak",id:"memory-leak",level:3},{value:"Danger Features",id:"danger-features",level:3},{value:"Function Performance",id:"function-performance",level:3},{value:"Local Variables Performance",id:"local-variables-performance",level:4},{value:"Scope Chain Performance",id:"scope-chain-performance",level:4},{value:"Memoization Function",id:"memoization-function",level:4},{value:"Loop Performance",id:"loop-performance",level:3},{value:"Math Performance",id:"math-performance",level:3},{value:"Bit Operators",id:"bit-operators",level:4},{value:"Reduce Repeat Manipulation",id:"reduce-repeat-manipulation",level:3},{value:"Timer Performance",id:"timer-performance",level:3},{value:"Time Slicing",id:"time-slicing",level:4},{value:"Task Batching and Scheduling",id:"task-batching-and-scheduling",level:4},{value:"Debounce and Throttle",id:"debounce-and-throttle",level:4},{value:"Animation Frame Throttling",id:"animation-frame-throttling",level:4},{value:"Event Delegation",id:"event-delegation",level:3},{value:"DOM Performance",id:"dom-performance",level:2},{value:"Layout and Paint Performance",id:"layout-and-paint-performance",level:3},{value:"DOM Manipulation Performance",id:"dom-manipulation-performance",level:3},{value:"Animation Frame Performance",id:"animation-frame-performance",level:3},{value:"CSSOM Performance",id:"cssom-performance",level:3},{value:"Browser Caches",id:"browser-caches",level:2},{value:"HTTP Cache",id:"http-cache",level:3},{value:"Local Cache",id:"local-cache",level:4},{value:"Server Cache",id:"server-cache",level:4},{value:"Code Cache",id:"code-cache",level:3},{value:"Render Blocking Resources",id:"render-blocking-resources",level:2},{value:"Render Blocking Resources Type",id:"render-blocking-resources-type",level:3},{value:"Render Blocking Resources Performance",id:"render-blocking-resources-performance",level:3},{value:"Images Performance",id:"images-performance",level:2},{value:"Responsive Images",id:"responsive-images",level:3},{value:"Pre-fetch Loading Images",id:"pre-fetch-loading-images",level:3},{value:"Lazy Loading Images",id:"lazy-loading-images",level:3},{value:"Placeholder Images",id:"placeholder-images",level:3},{value:"Images Format",id:"images-format",level:3},{value:"Images Compression and Minification",id:"images-compression-and-minification",level:3},{value:"Images Performance Reference",id:"images-performance-reference",level:3},{value:"Web Loading Performance",id:"web-loading-performance",level:2},{value:"Data Preloading",id:"data-preloading",level:3},{value:"Data PreFetching",id:"data-prefetching",level:3},{value:"Loading Priority",id:"loading-priority",level:3},{value:"Images Lazy Loading",id:"images-lazy-loading",level:3},{value:"JavaScript Lazy Loading",id:"javascript-lazy-loading",level:3},{value:"Script Lazy Loading",id:"script-lazy-loading",level:4},{value:"Script Dynamic Loading",id:"script-dynamic-loading",level:4},{value:"Babel Configuration",id:"babel-configuration",level:4},{value:"Data Loading Best Practice",id:"data-loading-best-practice",level:3},{value:"Data Loading Reference",id:"data-loading-reference",level:3},{value:"Performance Monitoring",id:"performance-monitoring",level:2},{value:"Synthetic Monitoring",id:"synthetic-monitoring",level:3},{value:"Real User Monitoring",id:"real-user-monitoring",level:3},{value:"SYN and RUM",id:"syn-and-rum",level:3},{value:"Monitoring Methods",id:"monitoring-methods",level:3},{value:"Monitoring Standard API",id:"monitoring-standard-api",level:3},{value:"Monitoring Statistics Data",id:"monitoring-statistics-data",level:3},{value:"Monitoring Report Dimension",id:"monitoring-report-dimension",level:3},{value:"Monitoring Report Performance",id:"monitoring-report-performance",level:3},{value:"GIF Image Beacon",id:"gif-image-beacon",level:3},{value:"Performance Monitoring Reference",id:"performance-monitoring-reference",level:3},{value:"Web Vitals",id:"web-vitals",level:2},{value:"Web Performance API",id:"web-performance-api",level:3},{value:"FP",id:"fp",level:3},{value:"FCP",id:"fcp",level:3},{value:"LCP",id:"lcp",level:3},{value:"INP",id:"inp",level:3},{value:"CLS",id:"cls",level:3},{value:"Core Web Vitals",id:"core-web-vitals",level:3},{value:"Web Vitals Reference",id:"web-vitals-reference",level:3},{value:"PRPL Pattern",id:"prpl-pattern",level:2},{value:"Performance Best Practice",id:"performance-best-practice",level:2},{value:"Performance Tools",id:"performance-tools",level:2},{value:"Performance Reference",id:"performance-reference",level:2}];function o(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"javascript-performance-notes",children:"JavaScript Performance Notes"})}),"\n",(0,r.jsx)(n.h2,{id:"effective-javascript",children:"Effective JavaScript"}),"\n",(0,r.jsx)(n.h3,{id:"memory-leak",children:"Memory Leak"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Useless global vars (bind to window or document)."}),"\n",(0,r.jsx)(n.li,{children:"Useless DOM reference."}),"\n",(0,r.jsxs)(n.li,{children:["Incorrect closure.","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Unnecessary closure creation:\n\u95ed\u5305\u4f1a\u4fdd\u7559\u5b83\u4eec\u5305\u542b\u51fd\u6570\u7684\u4f5c\u7528\u57df, \u6240\u4ee5\u6bd4\u5176\u4ed6\u51fd\u6570\u66f4\u5360\u7528\u5185\u5b58."}),"\n",(0,r.jsx)(n.li,{children:"Useless callback functions."}),"\n",(0,r.jsxs)(n.li,{children:["Forgotten timer from ",(0,r.jsx)(n.code,{children:"setTimeout"}),"/",(0,r.jsx)(n.code,{children:"setInterval"}),":\nclear with ",(0,r.jsx)(n.code,{children:"clearTimeout"}),"/",(0,r.jsx)(n.code,{children:"clearInterval"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"Forgotten tick timer."}),"\n",(0,r.jsxs)(n.li,{children:["Forgotten event listener:\nclear with ",(0,r.jsx)(n.code,{children:"removeEventListener"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Forgotten subscriber:\nclear with ",(0,r.jsx)(n.code,{children:"unsubscribe(id)"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Forgotten console log:\nclear with ",(0,r.jsx)(n.code,{children:"babel"}),"/",(0,r.jsx)(n.code,{children:"tsc"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Forgotten ",(0,r.jsx)(n.code,{children:"Set"}),"/",(0,r.jsx)(n.code,{children:"Map"}),":\n",(0,r.jsx)(n.code,{children:"WeakSet"}),"/",(0,r.jsx)(n.code,{children:"WeakMap"})," don't bother GC."]}),"\n",(0,r.jsx)(n.li,{children:"Circular reference."}),"\n",(0,r.jsxs)(n.li,{children:["Bad ",(0,r.jsx)(n.code,{children:"delete"})," Operator:\n",(0,r.jsx)(n.code,{children:"delete"})," \u64cd\u4f5c\u7b26\u5e76\u4e0d\u4f1a\u91ca\u653e\u5185\u5b58,\n\u800c\u4e14\u4f1a\u4f7f\u5f97\u9644\u52a0\u5230\u5bf9\u8c61\u4e0a\u7684\n",(0,r.jsx)(n.code,{children:"hidden class"})," (",(0,r.jsx)(n.code,{children:"V8"})," \u4e3a\u4e86\u4f18\u5316\u5c5e\u6027\u8bbf\u95ee\u65f6\u95f4\u800c\u521b\u5efa\u7684\u9690\u85cf\u7c7b) \u5931\u6548,\n\u8ba9\u5bf9\u8c61\u53d8\u6210 ",(0,r.jsx)(n.code,{children:"slow object"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"danger-features",children:"Danger Features"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"eval()"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"with () {}"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"new Function()"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"function-performance",children:"Function Performance"}),"\n",(0,r.jsx)(n.h4,{id:"local-variables-performance",children:"Local Variables Performance"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u5c40\u90e8\u53d8\u91cf\u5f15\u7528\u5168\u5c40\u53d8\u91cf/\u5168\u5c40\u53d8\u91cf\u4f5c\u4e3a\u53c2\u6570\u4f20\u5165\u51fd\u6570: \u52a0\u5feb\u7b26\u53f7\u89e3\u6790."}),"\n",(0,r.jsx)(n.li,{children:"\u5c40\u90e8\u53d8\u91cf\u7f13\u5b58 DOM \u5143\u7d20."}),"\n",(0,r.jsx)(n.li,{children:"\u5c40\u90e8\u53d8\u91cf\u7f13\u5b58\u5e03\u5c40\u4fe1\u606f."}),"\n",(0,r.jsx)(n.li,{children:"\u5c40\u90e8\u53d8\u91cf\u5f15\u7528\u5d4c\u5957\u6210\u5458: \u52a0\u5feb\u539f\u578b\u94fe\u67e5\u627e."}),"\n",(0,r.jsx)(n.li,{children:"\u5c40\u90e8\u53d8\u91cf\u5f15\u7528\u65b9\u6cd5\u65f6, \u5e94\u6ce8\u610f\u4f1a\u52a8\u6001\u6539\u53d8 this \u6307\u9488."}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const DOM = tazimi.util.Dom\n\nDOM.method.call(/* \u5173\u6ce8 this \u6307\u9488 */)\n"})}),"\n",(0,r.jsx)(n.h4,{id:"scope-chain-performance",children:"Scope Chain Performance"}),"\n",(0,r.jsxs)(n.p,{children:["\u7531\u4e8e\u4f5c\u7528\u57df\u94fe\u7684\u5173\u7cfb, \u6807\u8bc6\u7b26\u89e3\u6790\u65f6,\n\u5bfb\u627e\u5c40\u90e8\u53d8\u91cf\u901f\u5ea6\u8fdc\u5feb\u4e8e\u5bfb\u627e\u5168\u5c40\u53d8\u91cf\u901f\u5ea6 (\u4f5c\u7528\u57df\u94fe\u8d8a\u957f, \u67e5\u627e\u53d8\u91cf\u6240\u9700\u65f6\u95f4\u8d8a\u957f).\n\u6545\u5e94\u5c06\u5168\u5c40\u53d8\u91cf\u4f5c\u4e3a\u53c2\u6570\u4f20\u5165\u51fd\u6570\u8fdb\u884c\u8c03\u7528, \u4e0d\u4f46\u6548\u7387\u9ad8, \u800c\u4e14\u6613\u4e8e\u7ef4\u62a4\u4e0e\u6d4b\u8bd5.\n\u5373",(0,r.jsx)(n.strong,{children:"\u5229\u7528\u5c40\u90e8\u53d8\u91cf\u5f15\u7528\u5168\u5c40\u53d8\u91cf, \u52a0\u5feb\u6807\u8bc6\u7b26\u89e3\u6790"}),"."]}),"\n",(0,r.jsx)(n.h4,{id:"memoization-function",children:"Memoization Function"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"function memoize(fn) {\n  return (\n    (cache = Object.create(null)) =>\n      (...args) => {\n        return cache[args] || (cache[args] = fn(...args))\n      }\n  )()\n}\n\nconst memoizedGetDistance = memoize(getDistance)\n\nmemoizedGetDistance('Murcia', 'Madrid') // => computed, slow\nmemoizedGetDistance('Murcia', 'Madrid') // => cached, fast!\n"})}),"\n",(0,r.jsx)(n.h3,{id:"loop-performance",children:"Loop Performance"}),"\n",(0,r.jsx)(n.p,{children:"\u5012\u5e8f\u5faa\u73af\u53ef\u63d0\u5347\u6027\u80fd:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"for (let i = item.length; i--;)\n  process(items[i])\n\nlet j = items.length\nwhile (j--)\n  process(items[i])\n\nlet k = items.length\ndo\n  process(items[k])\nwhile (k--)\n"})}),"\n",(0,r.jsx)(n.p,{children:"Duff's Device:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"let i = items.length % 8\n\nwhile (i)\n  process(items[i--])\n\ni = Math.floor(items.length / 8)\n\nwhile (i) {\n  process(items[i--])\n  process(items[i--])\n  process(items[i--])\n  process(items[i--])\n  process(items[i--])\n  process(items[i--])\n  process(items[i--])\n  process(items[i--])\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"math-performance",children:"Math Performance"}),"\n",(0,r.jsx)(n.h4,{id:"bit-operators",children:"Bit Operators"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"i%2"})," => ",(0,r.jsx)(n.code,{children:"i&0x1"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"\u4f4d\u63a9\u7801"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const OPTION_A = 1\nconst OPTION_B = 2\nconst OPTION_C = 4\nconst OPTION_D = 8\nconst OPTION_E = 16\n\nconst options = OPTION_A | OPTION_C | OPTION_D\n"})}),"\n",(0,r.jsx)(n.h3,{id:"reduce-repeat-manipulation",children:"Reduce Repeat Manipulation"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u7279\u6027/\u6d4f\u89c8\u5668\u68c0\u6d4b\u4ee3\u7801\u53ea\u8fd0\u884c\u4e00\u6b21."}),"\n",(0,r.jsx)(n.li,{children:"\u60f0\u6027\u5b9a\u4e49\u6a21\u5f0f/\u81ea\u5b9a\u4e49\u6a21\u5f0f."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"timer-performance",children:"Timer Performance"}),"\n",(0,r.jsx)(n.p,{children:"JavaScript \u4ee3\u7801\u4e0e UI \u5171\u4eab\u7ebf\u7a0b."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"setTimeout"}),"/",(0,r.jsx)(n.code,{children:"setInterval"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u7b2c\u4e8c\u4e2a\u53c2\u6570: \u4e0d\u662f\u6267\u884c\u65f6\u95f4, \u662f\u52a0\u5165\u6267\u884c\u961f\u5217\u65f6\u95f4."}),"\n",(0,r.jsx)(n.li,{children:"\u82e5\u5176\u4ed6\u4f4d\u4e8e\u6267\u884c\u961f\u5217\u4e2d\u7684\u51fd\u6570\u6267\u884c\u65f6\u95f4\u8d85\u8fc7\u5ef6\u65f6, \u5219\u7528\u6237\u611f\u89c9\u4e0d\u5230\u5ef6\u65f6\u7684\u5b58\u5728."}),"\n",(0,r.jsx)(n.li,{children:"\u6a21\u62df\u6709\u95f4\u9699\u7684\u5faa\u73af, \u4f7f\u5f97 UI \u66f4\u65b0\u5f97\u4ee5\u8fdb\u5165\u6d4f\u89c8\u5668\u7ebf\u7a0b\u7684\u6267\u884c\u961f\u5217\u4e2d."}),"\n",(0,r.jsxs)(n.li,{children:["\u901a\u8fc7 MicroTask/MicroTask \u5b9e\u73b0\u65f6\u95f4\u5206\u7247\u8c03\u5ea6\u5668,\n\u4f7f\u5f97\u957f\u4efb\u52a1\u4e0d\u963b\u585e\u9875\u9762\u64cd\u4f5c (60 FPS):\ne.g React Scheduler and Reconciler, Vue ",(0,r.jsx)(n.code,{children:"nextTick"})," API."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const button = document.getElementById('myButton')\n\nbutton.onclick = function () {\n  oneMethod()\n\n  setTimeout(() => {\n    document.getElementById('notice').style.color = 'red'\n  }, 250)\n}\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"/*\n * usage: start -> stop -> getTime\n */\nconst Timer = {\n  _data: {},\n  start(key) {\n    Timer._data[key] = new Date()\n  },\n  stop(key) {\n    const time = Timer._data[key]\n\n    if (time)\n      Timer._data[key] = new Date() - time\n  },\n  getTime(key) {\n    return Timer._data[key]\n  },\n}\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"function pollTimerTask(time) {\n  if (timerQueue.length === 0)\n    return\n\n  while (timerQueue[0] && time >= timerQueue[0].time) {\n    const timer = timerQueue.shift()\n\n    while (timer.tickerQueue.length) {\n      const { id, callback, delay, loop, defer } = timer.tickerQueue.shift()\n\n      callback(time)\n\n      if (loop && idPool[id].exist) {\n        let nextTime = timer.time + delay\n\n        // \u5f53\u56de\u8c03\u51fd\u6570\u6267\u884c\u65f6\u95f4\u8d85\u8fc7\u591a\u4e2a\u6267\u884c\u5468\u671f\u65f6\n        if (time - nextTime > delay) {\n          nextTime = nextTime + Math.floor((time - nextTime) / delay) * delay\n\n          // \u5ef6\u8fdf\u6267\u884c\u65f6, \u5c06 nextTime \u63a8\u8fdf\u81f3\u4e0b\u4e00\u4e2a\u6267\u884c\u5468\u671f\n          defer && (nextTime += delay)\n        }\n\n        registerTimerWithId({\n          id,\n          callback,\n          time: nextTime,\n          delay,\n          loop,\n          defer,\n        })\n      } else {\n        // \u5f53\u56de\u8c03\u51fd\u6570\u4e0d\u9700\u8981\u5468\u671f\u6267\u884c\u6216\u5728\u56de\u8c03\u51fd\u6570\u4e2d\u6267\u884c unregister \u65f6\n        delete idPool[id]\n      }\n    }\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h4,{id:"time-slicing",children:"Time Slicing"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"function saveDocument(id) {\n  // \u5229\u7528\u95ed\u5305\u5c01\u88c5\u5f85\u6267\u884c\u4efb\u52a1\n  const tasks = [openDocument, writeText, closeDocument, updateUI]\n\n  setTimeout(function sliceTask() {\n    // \u6267\u884c\u4e0b\u4e00\u4e2a\u4efb\u52a1\n    const task = tasks.shift()\n    task(id)\n\n    // \u68c0\u67e5\u662f\u5426\u8fd8\u6709\u5176\u4ed6\u4efb\u52a1\n    if (tasks.length > 0) {\n      // \u9012\u5f52\u8c03\u7528(\u6bcf\u6b21\u53c2\u6570\u4e0d\u540c)\n      setTimeout(sliceTask, 25)\n    }\n  }, 25)\n}\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"function processArray(items, process, callback) {\n  // \u514b\u9686\u539f\u6570\u7ec4\n  const todo = items.concat()\n\n  setTimeout(function sliceTask() {\n    process(todo.shift())\n\n    if (todo.length > 0)\n      setTimeout(sliceTask, 25)\n    else\n      callback(items)\n  }, 25)\n}\n"})}),"\n",(0,r.jsx)(n.h4,{id:"task-batching-and-scheduling",children:"Task Batching and Scheduling"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/Prioritized_Task_Scheduling_API",children:"Prioritized task scheduler API"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"async function saveSettings() {\n  const tasks = [\n    validateForm,\n    showSpinner,\n    saveToDatabase,\n    updateUI,\n    sendAnalytics,\n  ]\n\n  let deadline = performance.now() + 50\n\n  while (tasks.length > 0) {\n    if (\n      navigator.scheduling?.isInputPending()\n      || performance.now() >= deadline\n    ) {\n      // 1. Pending user input.\n      // 2. deadline has been reached.\n      // Yield here:\n      await yieldToMain()\n\n      // Extend the deadline.\n      deadline += 50\n      continue\n    }\n\n    // Run task.\n    const task = tasks.shift()\n    task()\n  }\n}\n\nfunction yieldToMain() {\n  return new Promise((resolve) => {\n    setTimeout(resolve, 0)\n  })\n}\n"})}),"\n",(0,r.jsx)(n.h4,{id:"debounce-and-throttle",children:"Debounce and Throttle"}),"\n",(0,r.jsx)(n.p,{children:"\u9632\u6296\u52a8\u548c\u8282\u6d41\u672c\u8d28\u662f\u4e0d\u4e00\u6837\u7684:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"debounce"}),":\n\u9632\u6296\u52a8\u662f\u5c06\u591a\u6b21\u6267\u884c\u53d8\u4e3a\u6700\u540e\u4e00\u6b21\u6267\u884c (\u53ef\u7528\u4e8e\u68c0\u6d4b\u67d0\u4e2a\u8fde\u7eed\u7684 DOM \u64cd\u4f5c\u7ed3\u675f, \u5982 ",(0,r.jsx)(n.code,{children:"resize"}),"/",(0,r.jsx)(n.code,{children:"scroll"})," \u505c\u6b62)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"throttle"}),":\n\u8282\u6d41\u662f\u5c06\u591a\u6b21\u6267\u884c\u53d8\u6210\u6bcf\u9694\u4e00\u6bb5\u65f6\u95f4\u6267\u884c (\u4fdd\u8bc1\u4e00\u5b9a\u65f6\u95f4\u5185\u53ea\u6267\u884c\u4e00\u6b21)."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Simple debounce:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"function debounce(action, delay) {\n  let timer = null\n\n  return function () {\n    if (timer)\n      clearTimeout(timer)\n    timer = setTimeout(() => {\n      action()\n    }, delay)\n  }\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:"Simple throttle:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"function throttle(action) {\n  let isRunning = false\n\n  return function () {\n    if (isRunning)\n      return\n\n    isRunning = true\n\n    window.requestAnimationFrame(() => {\n      action()\n      isRunning = false\n    })\n  }\n}\n\nfunction throttle(func, timeFrame) {\n  let lastTime = 0\n\n  return function (...args) {\n    const now = new Date()\n\n    if (now - lastTime >= timeFrame) {\n      func(...args)\n      lastTime = now\n    }\n  }\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:"Lodash debounce:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"// \u8fd9\u4e2a\u662f\u7528\u6765\u83b7\u53d6\u5f53\u524d\u65f6\u95f4\u6233\u7684\nfunction now() {\n  return +new Date()\n}\n\n/**\n * \u9632\u6296\u51fd\u6570, \u8fd4\u56de\u51fd\u6570\u8fde\u7eed\u8c03\u7528\u65f6, \u7a7a\u95f2\u65f6\u95f4\u5fc5\u987b\u5927\u4e8e\u6216\u7b49\u4e8e wait, func \u624d\u4f1a\u6267\u884c\n *\n * @param  {Function} func        \u56de\u8c03\u51fd\u6570\n * @param  {number}   wait        \u8868\u793a\u65f6\u95f4\u7a97\u53e3\u7684\u95f4\u9694\n * @param  {boolean}  immediate   \u8bbe\u7f6e\u4e3a true \u65f6, \u662f\u5426\u7acb\u5373\u8c03\u7528\u51fd\u6570\n * @return {Function}             \u8fd4\u56de\u5ba2\u6237\u8c03\u7528\u51fd\u6570\n */\nfunction debounce(func, wait = 50, immediate = true) {\n  let timer, context, args\n\n  // \u5ef6\u8fdf\u6267\u884c\u51fd\u6570\n  const later = () =>\n    setTimeout(() => {\n      // \u5ef6\u8fdf\u51fd\u6570\u6267\u884c\u5b8c\u6bd5, \u6e05\u7a7a\u7f13\u5b58\u7684\u5b9a\u65f6\u5668\u5e8f\u53f7\n      timer = null\n      // \u5ef6\u8fdf\u6267\u884c\u7684\u60c5\u51b5\u4e0b, \u51fd\u6570\u4f1a\u5728\u5ef6\u8fdf\u51fd\u6570\u4e2d\u6267\u884c\n      // \u4f7f\u7528\u5230\u4e4b\u524d\u7f13\u5b58\u7684\u53c2\u6570\u548c\u4e0a\u4e0b\u6587\n      if (!immediate) {\n        func.apply(context, args)\n        context = args = null\n      }\n    }, wait)\n\n  // \u8fd9\u91cc\u8fd4\u56de\u7684\u51fd\u6570\u662f\u6bcf\u6b21\u5b9e\u9645\u8c03\u7528\u7684\u51fd\u6570\n  return function (...params) {\n    // \u5982\u679c\u6ca1\u6709\u521b\u5efa\u5ef6\u8fdf\u6267\u884c\u51fd\u6570 (later), \u5c31\u521b\u5efa\u4e00\u4e2a\n    if (!timer) {\n      timer = later()\n      // \u5982\u679c\u662f\u7acb\u5373\u6267\u884c, \u8c03\u7528\u51fd\u6570\n      // \u5426\u5219\u7f13\u5b58\u53c2\u6570\u548c\u8c03\u7528\u4e0a\u4e0b\u6587\n      if (immediate) {\n        func.apply(this, params)\n      } else {\n        // eslint-disable-next-line ts/no-this-alias\n        context = this\n        args = params\n      }\n    } else {\n      // \u5982\u679c\u5df2\u6709\u5ef6\u8fdf\u6267\u884c\u51fd\u6570 (later), \u8c03\u7528\u7684\u65f6\u5019\u6e05\u9664\u539f\u6765\u7684\u5e76\u91cd\u65b0\u8bbe\u5b9a\u4e00\u4e2a\n      // \u8fd9\u6837\u505a\u5ef6\u8fdf\u51fd\u6570\u4f1a\u91cd\u65b0\u8ba1\u65f6\n      clearTimeout(timer)\n      timer = later()\n    }\n  }\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:"Lodash throttle:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"/**\n * Lodash \u8282\u6d41\u51fd\u6570, \u8fd4\u56de\u51fd\u6570\u8fde\u7eed\u8c03\u7528\u65f6, func \u6267\u884c\u9891\u7387\u9650\u5b9a\u4e3a \u6b21 / wait\n *\n * @param  {Function}   func      \u56de\u8c03\u51fd\u6570\n * @param  {number}     wait      \u8868\u793a\u65f6\u95f4\u7a97\u53e3\u7684\u95f4\u9694\n * @param  {object}     options   \u5982\u679c\u60f3\u5ffd\u7565\u5f00\u59cb\u51fd\u6570\u7684\u7684\u8c03\u7528, \u4f20\u5165{leading: false}.\n *                                \u5982\u679c\u60f3\u5ffd\u7565\u7ed3\u5c3e\u51fd\u6570\u7684\u8c03\u7528, \u4f20\u5165{trailing: false}\n *                                \u4e24\u8005\u4e0d\u80fd\u5171\u5b58, \u5426\u5219\u51fd\u6570\u4e0d\u80fd\u6267\u884c\n * @return {Function}             \u8fd4\u56de\u5ba2\u6237\u8c03\u7528\u51fd\u6570\n */\n_.throttle = function (func, wait, options) {\n  let context, args, result\n  let timeout = null\n  // \u4e4b\u524d\u7684\u65f6\u95f4\u6233\n  let previous = 0\n  // \u5982\u679c options \u6ca1\u4f20\u5219\u8bbe\u4e3a\u7a7a\u5bf9\u8c61\n  if (!options)\n    options = {}\n\n  // \u5b9a\u65f6\u5668\u56de\u8c03\u51fd\u6570\n  const later = function () {\n    // \u5982\u679c\u8bbe\u7f6e\u4e86 leading, \u5c31\u5c06 previous \u8bbe\u4e3a 0\n    // \u7528\u4e8e\u4e0b\u9762\u51fd\u6570\u7684\u7b2c\u4e00\u4e2a if \u5224\u65ad\n    previous = options.leading === false ? 0 : _.now()\n    // \u7f6e\u7a7a\u4e00\u662f\u4e3a\u4e86\u9632\u6b62\u5185\u5b58\u6cc4\u6f0f, \u4e8c\u662f\u4e3a\u4e86\u4e0b\u9762\u7684\u5b9a\u65f6\u5668\u5224\u65ad\n    timeout = null\n    result = func.apply(context, args)\n    if (!timeout)\n      context = args = null\n  }\n\n  return function (...original_args) {\n    // \u83b7\u5f97\u5f53\u524d\u65f6\u95f4\u6233\n    const now = _.now()\n\n    // \u9996\u6b21\u8fdb\u5165\u524d\u8005\u80af\u5b9a\u4e3a true\n    // \u5982\u679c\u9700\u8981\u7b2c\u4e00\u6b21\u4e0d\u6267\u884c\u51fd\u6570\n    // \u5c31\u5c06\u4e0a\u6b21\u65f6\u95f4\u6233\u8bbe\u4e3a\u5f53\u524d\u7684\n    // \u8fd9\u6837\u5728\u63a5\u4e0b\u6765\u8ba1\u7b97 remaining \u7684\u503c\u65f6\u4f1a\u5927\u4e8e0\n    if (!previous && options.leading === false)\n      previous = now\n\n    // \u8ba1\u7b97\u5269\u4f59\u65f6\u95f4\n    const remaining = wait - (now - previous)\n    // eslint-disable-next-line ts/no-this-alias\n    context = this\n    args = original_args\n\n    // \u5982\u679c\u5f53\u524d\u8c03\u7528\u5df2\u7ecf\u5927\u4e8e\u4e0a\u6b21\u8c03\u7528\u65f6\u95f4 + wait\n    // \u6216\u8005\u7528\u6237\u624b\u52a8\u8c03\u4e86\u65f6\u95f4\n    // \u5982\u679c\u8bbe\u7f6e\u4e86 trailing, \u53ea\u4f1a\u8fdb\u5165\u8fd9\u4e2a\u6761\u4ef6\n    // \u5982\u679c\u6ca1\u6709\u8bbe\u7f6e leading, \u90a3\u4e48\u7b2c\u4e00\u6b21\u4f1a\u8fdb\u5165\u8fd9\u4e2a\u6761\u4ef6\n    // \u8fd8\u6709\u4e00\u70b9, \u4f60\u53ef\u80fd\u4f1a\u89c9\u5f97\u5f00\u542f\u4e86\u5b9a\u65f6\u5668\u90a3\u4e48\u5e94\u8be5\u4e0d\u4f1a\u8fdb\u5165\u8fd9\u4e2a if \u6761\u4ef6\u4e86\n    // \u5176\u5b9e\u8fd8\u662f\u4f1a\u8fdb\u5165\u7684, \u56e0\u4e3a\u5b9a\u65f6\u5668\u7684\u5ef6\u65f6\n    // \u5e76\u4e0d\u662f\u51c6\u786e\u7684\u65f6\u95f4, \u5f88\u53ef\u80fd\u4f60\u8bbe\u7f6e\u4e862\u79d2\n    // \u4f46\u662f\u4ed6\u9700\u89812.2\u79d2\u624d\u89e6\u53d1, \u8fd9\u65f6\u5019\u5c31\u4f1a\u8fdb\u5165\u8fd9\u4e2a\u6761\u4ef6\n    if (remaining <= 0 || remaining > wait) {\n      // \u5982\u679c\u5b58\u5728\u5b9a\u65f6\u5668\u5c31\u6e05\u7406\u6389\u5426\u5219\u4f1a\u8c03\u7528\u4e8c\u6b21\u56de\u8c03\n      if (timeout) {\n        clearTimeout(timeout)\n        timeout = null\n      }\n\n      previous = now\n      result = func.apply(context, args)\n      if (!timeout)\n        context = args = null\n    } else if (!timeout && options.trailing !== false) {\n      // \u5224\u65ad\u662f\u5426\u8bbe\u7f6e\u4e86\u5b9a\u65f6\u5668\u548c trailing\n      // \u6ca1\u6709\u7684\u8bdd\u5c31\u5f00\u542f\u4e00\u4e2a\u5b9a\u65f6\u5668\n      // \u5e76\u4e14\u4e0d\u80fd\u4e0d\u80fd\u540c\u65f6\u8bbe\u7f6e leading \u548c trailing\n      timeout = setTimeout(later, remaining)\n    }\n\n    return result\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h4,{id:"animation-frame-throttling",children:"Animation Frame Throttling"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"function useAnimation() {\n  const frameId = useRef(0)\n  const ticking = useRef(false)\n\n  const handleResize = (event) => {\n    if (ticking.current)\n      return\n    ticking.current = true\n    frameId.current = requestAnimationFrame(() => handleUpdate(event))\n  }\n\n  const handleUpdate = (event) => {\n    console.log('resize update')\n    ticking.current = false\n  }\n\n  useMount(() => {\n    window.addEventListener('resize', handleResize)\n    handleUpdate()\n\n    return () => {\n      window.removeEventListener('resize', handleResize)\n      cancelAnimationFrame(frameId.current)\n    }\n  })\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"event-delegation",children:"Event Delegation"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u4e8b\u4ef6\u59d4\u6258\u5229\u7528\u7684\u662f\u4e8b\u4ef6\u5192\u6ce1\u673a\u5236, \u53ea\u5236\u5b9a\u4e00\u4e8b\u4ef6\u5904\u7406\u7a0b\u5e8f, \u5c31\u53ef\u4ee5\u7ba1\u7406\u67d0\u4e00\u7c7b\u578b\u7684\u6240\u6709\u4e8b\u4ef6."}),"\n",(0,r.jsxs)(n.li,{children:["Increases performance and reduces memory consumption:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u4f7f\u7528\u4e8b\u4ef6\u59d4\u6258, \u53ea\u9700\u5728 DOM \u6811\u4e2d\u5c3d\u91cf\u6700\u9ad8\u7684\u5c42\u6b21\u4e0a\u6dfb\u52a0\u4e00\u4e2a\u4e8b\u4ef6\u5904\u7406\u7a0b\u5e8f."}),"\n",(0,r.jsx)(n.li,{children:"No need to register new event listeners for newer children."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"DOM Event:\nEvent Capturing (default false) ->\nEvent Target ->\nEvent Bubbling (default true)."}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"window.onload = function () {\n  const oUl = document.getElementById('ul')\n  const aLi = oUl.getElementsByTagName('li')\n\n  oUl.onmouseover = function (e) {\n    const e = e || window.event\n    const target = e.target || e.srcElement\n\n    // alert(target.innerHTML);\n\n    if (target.nodeName.toLowerCase() === 'li')\n      target.style.background = 'red'\n\n    // \u963b\u6b62\u9ed8\u8ba4\u884c\u4e3a\u5e76\u53d6\u6d88\u5192\u6ce1\n    if (typeof e.preventDefault === 'function') {\n      e.preventDefault()\n      e.stopPropagation()\n    } else {\n      e.returnValue = false\n      e.cancelBubble = true\n    }\n  }\n\n  oUl.onmouseout = function (e) {\n    const e = e || window.event\n    const target = e.target || e.srcElement\n\n    // alert(target.innerHTML);\n\n    if (target.nodeName.toLowerCase() === 'li')\n      target.style.background = ''\n\n    // \u963b\u6b62\u9ed8\u8ba4\u884c\u4e3a\u5e76\u53d6\u6d88\u5192\u6ce1\n    if (typeof e.preventDefault === 'function') {\n      e.preventDefault()\n      e.stopPropagation()\n    } else {\n      e.returnValue = false\n      e.cancelBubble = true\n    }\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"dom-performance",children:"DOM Performance"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u5c40\u90e8\u53d8\u91cf\u7f13\u5b58 DOM \u5143\u7d20."}),"\n",(0,r.jsx)(n.li,{children:"\u5c40\u90e8\u53d8\u91cf\u7f13\u5b58\u5e03\u5c40\u4fe1\u606f."}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const btn = document.getElementById('btn')\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"HTML Collection \u8f6c\u5316\u6210\u6570\u7ec4\u518d\u64cd\u4f5c."}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"function toArray(coll) {\n  for (let i = 0, a = [], len = coll.length; i < len; i++)\n    a[i] = coll[i]\n\n  return a\n}\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"children"})," \u4f18\u4e8e ",(0,r.jsx)(n.code,{children:"childNodes"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"childElementCount"})," \u4f18\u4e8e ",(0,r.jsx)(n.code,{children:"childNodes.length"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"firstElementChild"})," \u4f18\u4e8e ",(0,r.jsx)(n.code,{children:"firstChild"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"lastElementChild"})," \u4f18\u4e8e ",(0,r.jsx)(n.code,{children:"lastChild"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"nextElementSibling"})," \u4f18\u4e8e ",(0,r.jsx)(n.code,{children:"nextSibling"})," \u4f18\u4e8e ",(0,r.jsx)(n.code,{children:"childNodes[next]"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"previousElementSibling"})," \u4f18\u4e8e ",(0,r.jsx)(n.code,{children:"previousSibling"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"layout-and-paint-performance",children:"Layout and Paint Performance"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u91cd\u6392 (",(0,r.jsx)(n.code,{children:"reflow"}),"): \u91cd\u65b0\u6784\u9020\u6e32\u67d3\u6811, \u4ece ",(0,r.jsx)(n.code,{children:"layout"})," \u9636\u6bb5\u5f00\u59cb."]}),"\n",(0,r.jsxs)(n.li,{children:["\u91cd\u7ed8 (",(0,r.jsx)(n.code,{children:"repaint"}),"): \u91cd\u65b0\u7ed8\u5236\u53d7\u5f71\u54cd\u90e8\u5206, \u4ece ",(0,r.jsx)(n.code,{children:"paint"})," \u6216 ",(0,r.jsx)(n.code,{children:"composite"})," \u9636\u6bb5\u5f00\u59cb."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u83b7\u53d6"}),"\u6216\u6539\u53d8\u5e03\u5c40\u7684\u64cd\u4f5c\u4f1a\u5bfc\u81f4\u6e32\u67d3\u6811",(0,r.jsx)(n.strong,{children:"\u53d8\u5316\u961f\u5217"}),"\u5237\u65b0,\n\u6267\u884c\u6e32\u67d3\u961f\u5217\u4e2d\u7684",(0,r.jsx)(n.strong,{children:"\u5f85\u5904\u7406\u53d8\u5316"}),",\n\u91cd\u6392 DOM \u5143\u7d20."]}),"\n",(0,r.jsx)(n.h3,{id:"dom-manipulation-performance",children:"DOM Manipulation Performance"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u5148 ",(0,r.jsx)(n.code,{children:'display="none"'}),", \u4fee\u6539\u5b8c\u6210\u540e, ",(0,r.jsx)(n.code,{children:'display=""'}),"."]}),"\n",(0,r.jsx)(n.li,{children:"\u4f7f\u5f85\u4fee\u6539 DOM \u5143\u7d20\u8131\u79bb\u6807\u51c6\u6587\u6863\u6d41(\u6539\u53d8\u5e03\u5c40\uff0f\u5b9a\u4f4d\u65b9\u5f0f), \u53ef\u51cf\u5c11\u5176\u4ed6\u5143\u7d20\u7684\u91cd\u7ed8\u6b21\u6570."}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"document.createDocumentFragment()"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const fragment = document.createDocumentFragment()\nappendDataToElement(fragment, data)\ndocument.getElementById('myList').appendChild(fragment)\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"oldNode.cloneNode(true);"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const old = document.getElementById('myList')\nconst clone = old.cloneNode(true)\n\nappendDataToElement(clone, data)\nold.parentNode.replaceChild(clone, old)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"animation-frame-performance",children:"Animation Frame Performance"}),"\n",(0,r.jsxs)(n.p,{children:["run scripts as early as possible:\n",(0,r.jsx)(n.code,{children:"requestAnimationFrame()"})," runs after the CPU work is done (UI events and JS scripts),\nand just before the frame is rendered (layout, paint, composite etc.)."]}),"\n",(0,r.jsx)(n.h3,{id:"cssom-performance",children:"CSSOM Performance"}),"\n",(0,r.jsx)(n.p,{children:"\u5728 js \u4e2d(\u9664\u5b9a\u4f4d\u5c5e\u6027) \u5916, \u4e0d\u76f4\u63a5\u64cd\u4f5c element.style.attr/element.cssText:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"element.classList.add('className')\nelement.className += ' className'\n"})}),"\n",(0,r.jsx)(n.admonition,{title:"Pipeline",type:"tip",children:(0,r.jsx)(n.p,{children:"Script -> Style -> Layout -> Paint -> Composite."})}),"\n",(0,r.jsxs)(n.p,{children:["Make ",(0,r.jsx)(n.code,{children:"script"})," stage become: read then write.\nInterleaved read and write will trigger multiple times\nof re-layout/repaint/re-composite."]}),"\n",(0,r.jsx)(n.admonition,{title:"Forced Synchronous Layout",type:"danger",children:(0,r.jsx)(n.p,{children:"read css -> write css (re-layout/paint/composite)\n-> read css -> write css (re-layout/paint/composite)\n-> read css -> write css (re-layout/paint/composite)."})}),"\n",(0,r.jsx)(n.admonition,{title:"High Performance",type:"tip",children:(0,r.jsx)(n.p,{children:"read css -> write css (only re-layout/paint/composite once)."})}),"\n",(0,r.jsx)(n.h2,{id:"browser-caches",children:"Browser Caches"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://github.com/ljianshu/Blog/issues/23",children:"Browser caches"}),"\n\u4ece\u7f13\u5b58\u4f4d\u7f6e\u4e0a\u6765\u8bf4\u5206\u4e3a\u56db\u79cd, \u5e76\u4e14\u5404\u81ea\u6709\u4f18\u5148\u7ea7,\n\u5f53\u4f9d\u6b21\u67e5\u627e\u7f13\u5b58\u4e14\u90fd\u6ca1\u6709\u547d\u4e2d\u7684\u65f6\u5019, \u624d\u4f1a\u53bb\u8bf7\u6c42\u7f51\u7edc:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Service Worker: PWA."}),"\n",(0,r.jsx)(n.li,{children:"(In-) Memory Cache: reload Tab page."}),"\n",(0,r.jsx)(n.li,{children:"(On-) Disk Cache: big files."}),"\n",(0,r.jsx)(n.li,{children:"Push Cache: HTTP/2."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://web.dev/service-worker-caching-and-http-caching",children:(0,r.jsx)(n.img,{alt:"Browser Cache",src:i(8088).A+"",width:"1200",height:"514"})})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"// eslint-disable-next-line no-restricted-globals\nself.addEventListener('install', (event) => {\n  async function buildCache() {\n    const cache = await caches.open(cacheName)\n    return cache.addAll(['/main.css', '/main.mjs', '/offline.html'])\n  }\n  event.waitUntil(buildCache())\n})\n\n// eslint-disable-next-line no-restricted-globals\nself.addEventListener('fetch', (event) => {\n  async function cachedFetch(event) {\n    const cache = await caches.open(cacheName)\n    let response = await cache.match(event.request)\n    if (response)\n      return response\n    response = await fetch(event.request)\n    cache.put(event.request, response.clone())\n    return response\n  }\n  event.respondWith(cachedFetch(event))\n})\n"})}),"\n",(0,r.jsx)(n.h3,{id:"http-cache",children:"HTTP Cache"}),"\n",(0,r.jsxs)(n.p,{children:["\u6d4f\u89c8\u5668\u7f13\u5b58, \u4e5f\u79f0 ",(0,r.jsx)(n.a,{href:"https://web.dev/http-cache",children:"HTTP \u7f13\u5b58"}),",\n\u5206\u4e3a\u5f3a\u7f13\u5b58\u548c\u534f\u5546\u7f13\u5b58.\n\u4f18\u5148\u7ea7\u8f83\u9ad8\u7684\u662f\u5f3a\u7f13\u5b58,\n\u5728\u547d\u4e2d\u5f3a\u7f13\u5b58\u5931\u8d25\u7684\u60c5\u51b5\u4e0b\u6216\u8005\n",(0,r.jsx)(n.code,{children:"Cache-Control: no-cache"})," (",(0,r.jsx)(n.code,{children:"no-cache"})," allows caches but requires revalidate) \u65f6,\n\u624d\u4f1a\u8d70\u534f\u5546\u7f13\u5b58."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://developer.mozilla.org/docs/Web/HTTP/Caching",children:(0,r.jsx)(n.img,{alt:"HTTP Cache",src:i(9940).A+"",width:"519",height:"462"})})}),"\n",(0,r.jsx)(n.h4,{id:"local-cache",children:"Local Cache"}),"\n",(0,r.jsxs)(n.p,{children:["\u5f3a\u7f13\u5b58\u662f\u5229\u7528 HTTP \u5934\u4e2d\u7684 ",(0,r.jsx)(n.code,{children:"Expires"})," \u548c ",(0,r.jsx)(n.code,{children:"Cache-Control"})," \u4e24\u4e2a\u5b57\u6bb5\u6765\u63a7\u5236\u7684.\n\u5f3a\u7f13\u5b58\u4e2d, \u5f53\u8bf7\u6c42\u518d\u6b21\u53d1\u51fa\u65f6, \u6d4f\u89c8\u5668\u4f1a\u6839\u636e\u5176\u4e2d\u7684 ",(0,r.jsx)(n.code,{children:"Expires"})," \u548c ",(0,r.jsx)(n.code,{children:"Cache-Control"})," \u5224\u65ad\u76ee\u6807\u8d44\u6e90\u662f\u5426 ",(0,r.jsx)(n.code,{children:"\u547d\u4e2d"})," \u5f3a\u7f13\u5b58,\n\u82e5\u547d\u4e2d\u5219\u76f4\u63a5\u4ece\u7f13\u5b58\u4e2d\u83b7\u53d6\u8d44\u6e90, \u4e0d\u4f1a\u518d\u4e0e\u670d\u52a1\u7aef\u53d1\u751f\u901a\u4fe1.\n",(0,r.jsx)(n.code,{children:"Cache-Control"})," \u76f8\u5bf9\u4e8e ",(0,r.jsx)(n.code,{children:"Expires"})," \u66f4\u52a0\u51c6\u786e, \u5b83\u7684\u4f18\u5148\u7ea7\u4e5f\u66f4\u9ad8,\n\u5f53 ",(0,r.jsx)(n.code,{children:"Cache-Control"})," \u4e0e ",(0,r.jsx)(n.code,{children:"Expires"})," \u540c\u65f6\u51fa\u73b0\u65f6, \u4ee5 ",(0,r.jsx)(n.code,{children:"Cache-Control"})," \u4e3a\u51c6."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"Expires: Wed, 12 Sep 2019 06:12:18 GMT\nCache-Control: max-age=31536000\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"Cache-Control"})," directives:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"public"}),": \u5141\u8bb8\u4ee3\u7406\u670d\u52a1\u5668\u7f13\u5b58\u8d44\u6e90."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"private"}),": \u4e0d\u5141\u8bb8\u4ee3\u7406\u670d\u52a1\u5668\u7f13\u5b58\u8d44\u6e90, \u53ea\u6709\u6d4f\u89c8\u5668\u53ef\u4ee5\u7f13\u5b58."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"immutable"}),": \u5c31\u7b97\u8fc7\u671f\u4e86\u4e5f\u4e0d\u7528\u534f\u5546, \u8d44\u6e90\u5c31\u662f\u4e0d\u53d8\u7684."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"max-age=<time>"}),": \u8d44\u6e90\u8fc7\u671f\u65f6\u95f4 (\u6d4f\u89c8\u5668\u8ba1\u7b97), \u6bd4 ",(0,r.jsx)(n.code,{children:"Expires"})," \u7cbe\u51c6 (\u670d\u52a1\u5668\u8ba1\u7b97)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"s-maxage=<time>"}),": \u4ee3\u7406\u670d\u52a1\u5668\u7684\u8d44\u6e90\u8fc7\u671f\u65f6\u95f4."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"max-stale=<time>"}),": \u5141\u8bb8\u4f7f\u7528\u8fc7\u671f\u8d44\u6e90, \u6307\u5b9a\u5141\u8bb8\u65f6\u95f4."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"stale-while-revalidate=<time>"}),":\n\u5728\u9a8c\u8bc1 (\u534f\u5546) \u671f\u95f4, \u8fd4\u56de\u8fc7\u671f\u7684\u8d44\u6e90.\nIf the cached page has expired,\nthen it will send a stale version while it revalidate the page in the background.\nThe page load is never blocked for the user,\nthough it won't be perfectly fresh for everyone."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"stale-if-error=<time>"}),": \u9a8c\u8bc1 (\u534f\u5546) \u51fa\u9519\u7684\u8bdd, \u8fd4\u56de\u8fc7\u671f\u7684\u8d44\u6e90."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"must-revalidate"}),": \u5f3a\u7f13\u5b58\u8fc7\u671f\u540e, \u5f3a\u5236\u7b49\u5f85\u534f\u5546\u7f13\u5b58, \u4e0d\u5141\u8bb8\u4f7f\u7528\u8fc7\u671f\u8d44\u6e90."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"no-store"}),": \u7981\u6b62\u5f3a\u7f13\u5b58\u548c\u534f\u5546\u7f13\u5b58."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"no-cache"}),": \u7981\u6b62\u5f3a\u7f13\u5b58, \u5141\u8bb8\u534f\u5546\u7f13\u5b58."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Cache Control",src:i(4605).A+"",title:"Cache Control",width:"820",height:"739"})}),"\n",(0,r.jsxs)(n.p,{children:["Cache the response of the API request, serve the cached version to any visitor,\nbut automatically ",(0,r.jsx)(n.a,{href:"https://developers.netlify.com/guides/how-to-make-edge-rendering-fast",children:"revalidate the cached object in the background"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"export default async () => {\n  const resp = await fetch('https://hacker-news.firebaseio.com/v0/topstories.json')\n  const ids = await resp.json()\n\n  const stories = await Promise.all(\n    ids.slice(0, 100).map(async (id) => {\n      const story = await fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`)\n      return story.json()\n    })\n  )\n\n  return new Response(JSON.stringify(stories), {\n    headers: {\n      'content-type': 'application/json',\n      'netlify-cdn-cache-control': 'public, max-age=0, stale-while-revalidate=86400',\n    },\n  })\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Page is stale after 5 minutes,\nbut tells the CDN to return the stale response\nand ",(0,r.jsx)(n.a,{href:"https://developers.netlify.com/guides/how-to-do-advanced-caching-and-isr-with-astro",children:"regenerate it in the background unless it\u2019s over a week old"}),".\nA popular page will always be fresh, but a rarely-visited one will not keep re-rendering:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"// Tell the browser to always check the freshness of the cache\nAstro.response.headers.set('Cache-Control', 'public, max-age=0, must-revalidate')\n\n// Tell the CDN to treat it as fresh for 5 minutes,\n// then return a stale version while it revalidate.\nAstro.response.headers.set(\n  'Netlify-CDN-Cache-Control',\n  'public, s-maxage=604800, stale-while-revalidate=604800'\n)\n"})}),"\n",(0,r.jsx)(n.h4,{id:"server-cache",children:"Server Cache"}),"\n",(0,r.jsxs)(n.p,{children:["\u534f\u5546\u7f13\u5b58\u673a\u5236\u4e0b,\n\u6d4f\u89c8\u5668\u9700\u8981\u5411\u670d\u52a1\u5668\u53bb\u8be2\u95ee\u7f13\u5b58\u7684\u76f8\u5173\u4fe1\u606f,\n\u8fdb\u800c\u5224\u65ad\u662f\u91cd\u65b0\u53d1\u8d77\u8bf7\u6c42/\u4e0b\u8f7d\u5b8c\u6574\u7684\u54cd\u5e94,\n\u8fd8\u662f\u4ece\u672c\u5730\u83b7\u53d6\u7f13\u5b58\u7684\u8d44\u6e90.\n\u5982\u679c\u670d\u52a1\u7aef\u63d0\u793a\u7f13\u5b58\u8d44\u6e90\u672a\u6539\u52a8 (",(0,r.jsx)(n.code,{children:"Not Modified"}),"),\n\u8d44\u6e90\u4f1a\u88ab\u91cd\u5b9a\u5411\u5230\u6d4f\u89c8\u5668\u7f13\u5b58,\n\u8fd9\u79cd\u60c5\u51b5\u4e0b\u7f51\u7edc\u8bf7\u6c42\u5bf9\u5e94\u7684\u72b6\u6001\u7801\u662f ",(0,r.jsx)(n.code,{children:"304"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"Last-Modified"})," \u662f\u4e00\u4e2a\u65f6\u95f4\u6233,\n\u5982\u679c\u542f\u7528\u4e86\u534f\u5546\u7f13\u5b58,\n\u5b83\u4f1a\u5728\u9996\u6b21\u8bf7\u6c42\u65f6\u968f\u7740 response headers \u8fd4\u56de:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"Last-Modified: Fri, 27 Oct 2017 06:35:57 GMT\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u968f\u540e\u6bcf\u6b21\u8bf7\u6c42\u65f6, \u4f1a\u5e26\u4e0a\u4e00\u4e2a\u53eb ",(0,r.jsx)(n.code,{children:"If-Modified-Since"})," \u7684\u65f6\u95f4\u6233\u5b57\u6bb5,\n\u5b83\u7684\u503c\u6b63\u662f\u4e0a\u4e00\u6b21 response \u8fd4\u56de\u7ed9\u5b83\u7684 ",(0,r.jsx)(n.code,{children:"Last-Modified"})," \u503c:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"If-Modified-Since: Fri, 27 Oct 2017 06:35:57 GMT\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u670d\u52a1\u5668\u53ef\u80fd\u65e0\u6cd5\u6b63\u786e\u611f\u77e5\u6587\u4ef6\u7684\u53d8\u5316 (\u672a\u5b9e\u9645\u6539\u52a8\u6216\u6539\u52a8\u8fc7\u5feb),\n\u4e3a\u4e86\u89e3\u51b3\u8fd9\u6837\u7684\u95ee\u9898, ",(0,r.jsx)(n.code,{children:"Etag"})," \u4f5c\u4e3a ",(0,r.jsx)(n.code,{children:"Last-Modified"})," \u7684\u8865\u5145\u51fa\u73b0\u4e86.\n",(0,r.jsx)(n.code,{children:"Etag"})," \u662f\u7531\u670d\u52a1\u5668\u4e3a\u6bcf\u4e2a\u8d44\u6e90\u751f\u6210\u7684\u552f\u4e00\u7684\u6807\u8bc6\u5b57\u7b26\u4e32,\n\u8fd9\u4e2a\u6807\u8bc6\u5b57\u7b26\u4e32\u53ef\u4ee5\u662f\u57fa\u4e8e\u6587\u4ef6\u5185\u5bb9\u7f16\u7801\u7684,\n\u56e0\u6b64 ",(0,r.jsx)(n.code,{children:"Etag"})," \u80fd\u591f\u7cbe\u51c6\u5730\u611f\u77e5\u6587\u4ef6\u7684\u53d8\u5316."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'GET /i/example.gif HTTP 1.1\nHost: image.example.com\n\n------\n\nHTTP 1.1 200 OK\nLast-Modified: Tue, 12 Dec 2022 03:03:03 GMT\nETag: "10c24bc-4ab-457e1c1f"\nContent-Length: 1195\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'GET /i/example.gif HTTP 1.1\nHost: image.example.com\nIf-Modified-Since: Tue, 12 Dec 2022 03:03:03 GMT\nIf-None-Match: "10c24bc-4ab-457e1c1f"\n\n------\n\nHTTP 1.1 304 Not Modified\n'})}),"\n",(0,r.jsx)(n.h3,{id:"code-cache",children:"Code Cache"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["cold run: ",(0,r.jsx)(n.code,{children:"download -> compile -> store into on-disk cache"})]}),"\n",(0,r.jsxs)(n.li,{children:["warm run: ",(0,r.jsx)(n.code,{children:"fetch from browser cache -> compile -> store metadata"})]}),"\n",(0,r.jsxs)(n.li,{children:["hot run: ",(0,r.jsx)(n.code,{children:"fetch scripts and metadata from browser cache -> skip compile"})]}),"\n",(0,r.jsx)(n.li,{children:"positive case: IIFE function heuristics"}),"\n",(0,r.jsxs)(n.li,{children:["passive case: too small (",(0,r.jsx)(n.code,{children:"< 1KB"}),") and inline scripts"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"render-blocking-resources",children:"Render Blocking Resources"}),"\n",(0,r.jsx)(n.h3,{id:"render-blocking-resources-type",children:"Render Blocking Resources Type"}),"\n",(0,r.jsx)(n.p,{children:"Render blocking resources are files that 'press pause'\non the critical rendering path.\nThey interrupt one or more of the steps:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"HTML is technically render blocking resources\n(but not usually the cause of rendering performance problem)"}),"\n",(0,r.jsx)(n.li,{children:"CSS is render blocking:\nrender tree can't continue until both the CSSOM and DOM are created."}),"\n",(0,r.jsx)(n.li,{children:"JavaScript can be render blocking:\nwhen browser encounters a script meant to run synchronously,\nit will stop DOM creation until script finished."}),"\n",(0,r.jsx)(n.li,{children:"If CSS appears before a script,\nthe script will not be executed until the CSSOM is created:\nCSSOM -> CSS block JS -> JS block HTML parser."}),"\n",(0,r.jsx)(n.li,{children:"Images and fonts are not render blocking."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://sia.codes/posts/render-blocking-resources/#critical-render-path-js",children:(0,r.jsx)(n.img,{alt:"Critical Render Path",src:i(1428).A+"",width:"795",height:"859"})})}),"\n",(0,r.jsx)(n.h3,{id:"render-blocking-resources-performance",children:"Render Blocking Resources Performance"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Reduce CSS and JavaScript bytes."}),"\n",(0,r.jsx)(n.li,{children:"Lazy loading non-critical CSS and JavaScript."}),"\n",(0,r.jsxs)(n.li,{children:["Use the ",(0,r.jsx)(n.code,{children:"defer"}),", ",(0,r.jsx)(n.code,{children:"async"}),", or ",(0,r.jsx)(n.code,{children:"module"})," attribute on scripts."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"images-performance",children:"Images Performance"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Responsive images with ",(0,r.jsx)(n.code,{children:"srcset"})," (LCP):","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Modern format: WebP/SVG."}),"\n",(0,r.jsx)(n.li,{children:"Correspond size."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"Hero images pre-fetch loading (LCP)."}),"\n",(0,r.jsx)(n.li,{children:"Offscreen images lazy loading (INP)."}),"\n",(0,r.jsxs)(n.li,{children:["Critical render path blocking images (INP):","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Images compression and minification."}),"\n",(0,r.jsx)(n.li,{children:"Images CDN."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Images placeholder with ",(0,r.jsx)(n.code,{children:"aspect-ratio"})," (CLS)."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"responsive-images",children:"Responsive Images"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://danburzo.ro/responsive-images-html",children:"Responsive images"}),"\nprovide 3 ~ 5 different sizes reduce image transfer sizes by average of ",(0,r.jsx)(n.strong,{children:"~20%"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:'<picture>\n  <source\n    srcset="/media/filename.avif 300w, /media/filename.avif 500w, /media/filename.avif 2000w"\n    type="image/avif"\n    sizes="(max-width: 360px) 300px, (max-width: 720px) 500px, 2000px"\n  />\n  <source\n    srcset="/media/filename.webp 300w, /media/filename.webp 500w, /media/filename.webp 2000w"\n    type="image/webp"\n    sizes="(max-width: 360px) 300px, (max-width: 720px) 500px, 2000px"\n  />\n  <source\n    srcset="/media/filename.jpg 300w, /media/filename.jpg 500w, /media/filename.jpg 2000w"\n    type="image/jpeg"\n    sizes="(max-width: 360px) 300px, (max-width: 720px) 500px, 2000px"\n  />\n  <img\n    src="/media/filename.jpg"\n    srcset="/media/filename.jpg 300w, /media/filename.jpg 500w, /media/filename.jpg 2000w"\n    sizes="(max-width: 360px) 300px, (max-width: 720px) 500px, 2000px"\n    alt="Description of the image."\n    width="2000"\n    height="1333"\n    loading="lazy"\n    decoding="async"\n  />\n</picture>\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:'<img\n  src="keyboard-800w.jpg"\n  alt="A beautiful pink keyboard."\n  width="400"\n  height="400"\n  srcset="keyboard-400w.jpg 400w, keyboard-800w.jpg 800w"\n  sizes="(max-width: 640px) 400px, 800px"\n/>\n'})}),"\n",(0,r.jsx)(n.h3,{id:"pre-fetch-loading-images",children:"Pre-fetch Loading Images"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:'<link\n  rel="preload"\n  as="image"\n  href="keyboard.jpg"\n  imagesrcset="poster_400px.jpg 400w, poster_800px.jpg 800w, poster_1600px.jpg 1600w"\n  imagesizes="50vw"\n/>\n'})}),"\n",(0,r.jsx)(n.h3,{id:"lazy-loading-images",children:"Lazy Loading Images"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:'<img\n  src="donut-800w.jpg"\n  alt="A delicious pink donut"\n  width="400"\n  height="400"\n  srcset="donut-400w.jpg 400w, donut-800w.jpg 800w"\n  sizes="(max-width: 640px) 400px, 800px"\n  loading="lazy"\n/>\n'})}),"\n",(0,r.jsx)(n.h3,{id:"placeholder-images",children:"Placeholder Images"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:'<img\n  src="donut-800w.jpg"\n  alt="A delicious donut"\n  width="400"\n  height="400"\n  srcset="donut-400w.jpg 400w, donut-800w.jpg 800w"\n  sizes="(max-width: 640px) 400px, 800px"\n  loading="lazy"\n  decoding="async"\n  style="background-image: url(\'data:image/svg+xml;base64,[svg text]\'); background-size: cover"\n/>\n'})}),"\n",(0,r.jsx)(n.h3,{id:"images-format",children:"Images Format"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"mp4"})," smaller than ",(0,r.jsx)(n.code,{children:"gif"})," (",(0,r.jsx)(n.code,{children:"ffmpeg"}),"):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:'\x3c!-- ffmpeg -i dog.gif dog.mp4 --\x3e\n<video autoplay loop muted playsinline>\n  <source src="dog.mp4" type="video/mp4" />\n</video>\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"WebP"})," 25~35% smaller than ",(0,r.jsx)(n.code,{children:"jpg"}),"/",(0,r.jsx)(n.code,{children:"png"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:'<picture>\n  <source type="image/webp" srcset="flower.webp" />\n  <source type="image/jpeg" srcset="flower.jpg" />\n  <img src="flower.jpg" />\n</picture>\n'})}),"\n",(0,r.jsx)(n.h3,{id:"images-compression-and-minification",children:"Images Compression and Minification"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/lovell/sharp",children:"Sharp"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/oliver-moran/jimp",children:"Jimp"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/Klathmon/imagemin-webpack-plugin",children:"Imagemin"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"images-performance-reference",children:"Images Performance Reference"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Images format ",(0,r.jsx)(n.a,{href:"https://evilmartians.com/chronicles/images-done-right-web-graphics-good-to-the-last-byte-optimization-techniques",children:"guide"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Low effort images optimization ",(0,r.jsx)(n.a,{href:"https://blog.sentry.io/low-effort-image-optimization-tips",children:"tips"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Images optimization ",(0,r.jsx)(n.a,{href:"https://www.keycdn.com/blog/optimize-images-for-web",children:"guide"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Images optimization ",(0,r.jsx)(n.a,{href:"https://stackoverflow.blog/2022/03/28/picture-perfect-images-with-the-modern-element",children:"blog"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Images optimization ",(0,r.jsx)(n.a,{href:"https://www.smashingmagazine.com/printed-books/image-optimization",children:"book"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.admonition,{title:"CSS/Image Sprites",type:"danger",children:[(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Use image sprites ",(0,r.jsx)(n.strong,{children:"only on HTTP/1"})," to improve page-load times."]}),"\n",(0,r.jsx)(n.li,{children:"Avoid using image sprites on HTTP/2."}),"\n"]}),(0,r.jsx)(n.p,{children:"Legacy sprites optimization:"}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u6309\u989c\u8272\u5408\u5e76."}),"\n",(0,r.jsx)(n.li,{children:"\u6c34\u5e73\u6392\u5217\u5408\u5e76."}),"\n",(0,r.jsx)(n.li,{children:"\u907f\u514d\u4e0d\u5fc5\u8981\u7a7a\u767d."}),"\n",(0,r.jsx)(n.li,{children:"\u9650\u5236\u989c\u8272\u79cd\u7c7b."}),"\n",(0,r.jsx)(n.li,{children:"\u5148\u4f18\u5316\u5355\u72ec\u56fe\u50cf, \u518d\u4f18\u5316\u5408\u5e76\u56fe\u50cf"}),"\n"]})]}),"\n",(0,r.jsx)(n.h2,{id:"web-loading-performance",children:"Web Loading Performance"}),"\n",(0,r.jsx)(n.h3,{id:"data-preloading",children:"Data Preloading"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Generally, preloads will load in order parser gets to them for anything >= ",(0,r.jsx)(n.code,{children:"Medium"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Font preloads are probably best towards end of ",(0,r.jsx)(n.code,{children:"<head>"})," or beginning of ",(0,r.jsx)(n.code,{children:"<body>"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Import preloads should be done after ",(0,r.jsx)(n.code,{children:"<script>"})," tag that needs the import."]}),"\n",(0,r.jsx)(n.li,{children:"Image preloads will have a low priority (async scripts)."}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Role of ",(0,r.jsx)(n.a,{href:"https://web.dev/preload-scanner",children:"preload scanner"})," is speculative,\nmeaning that it examines ",(0,r.jsx)(n.strong,{children:"raw markup"})," (not scan CSS)\nin order to find resources to opportunistically fetch\nbefore the primary HTML parser would otherwise discover them."]}),"\n",(0,r.jsxs)(n.p,{children:["The preload scanner discovers the ",(0,r.jsx)(n.code,{children:"<img>"})," element\neven while rendering and document parsing is blocked,\nthe preload scanner will discover and fetch the image resource more quickly."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:'<link rel="modulepreload" href="critical-module.mjs" />\n<link rel="preload" as="script" href="critical.js" />\n<link rel="preload" as="fetch" href="..." crossorigin />\n<link rel="preload" as="font" href="myFont.woff2" type="font/woff2" crossorigin />\n<link\n  rel="preload"\n  as="image"\n  href="keyboard.jpg"\n  imagesrcset="poster_400px.jpg 400w, poster_800px.jpg 800w, poster_1600px.jpg 1600w"\n  imagesizes="50vw"\n/>\n<link rel="preload" as="video" href="https://cdn.com/small-file.mp4" />\n'})}),"\n",(0,r.jsx)(n.p,{children:"Preload scanner can be defeated (can't discover resources quickly):"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Injecting resources (scripts/images/styles) into DOM with JavaScript."}),"\n",(0,r.jsx)(n.li,{children:"Lazy-loading above-the-fold images or iframes using JavaScript solution."}),"\n",(0,r.jsx)(n.li,{children:"Rendering markup on client that contain document sub-resources using JavaScript."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"data-prefetching",children:"Data PreFetching"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://github.com/GoogleChromeLabs/quicklink",children:"Quick Link"}),"\nprefetch:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:'<link rel="prefetch" href="hero.jpg" as="image" />\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Pre-fetch and pre-render\n",(0,r.jsx)(n.a,{href:"https://addyosmani.com/blog/what-not-to-prefetch-prerender",children:"pitfalls"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Avoid prefetching pages for authentication."}),"\n",(0,r.jsx)(n.li,{children:"Avoid over-prefetching to limit accidental DOS."}),"\n",(0,r.jsx)(n.li,{children:"Avoid prefetching pages key to checkout."}),"\n",(0,r.jsx)(n.li,{children:"Avoid prefetching large resources."}),"\n",(0,r.jsx)(n.li,{children:"Avoid prefetching cross-origin resources."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"loading-priority",children:"Loading Priority"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://web.dev/priority-hints",children:"Fetch Priority"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://web.dev/prioritize-resources",children:"Resources Priority"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:'\x3c!-- link: initiate an early fetch but de-prioritize the script --\x3e\n<link href="/js/script.js" rel="preload" as="script" fetchpriority="low" />\n\n\x3c!-- img: de-prioritize an image in viewport --\x3e\n\x3c!-- that could be otherwise prioritized by the browser --\x3e\n<img src="/images/in-viewport-but-unimportant.svg" fetchpriority="low" alt="" />\n\n\x3c!-- script: prioritize critical script --\x3e\n<script src="/js/live-chat.js" fetchpriority="high"><\/script>\n\n\x3c!-- iframe: de-prioritize a third-party embed that\u2019s not essential --\x3e\n<iframe src="https://example.com" width="400" height="400" fetchpriority="low"></iframe>\n\n<script>\n  // Critical Fetch request for article content\n  fetch(\'/api/articles.json\', { priority: \'high\' }).then(/*...*/)\n\n  // Request for related content now reduced in priority\n  fetch(\'/api/related.json\', { priority: \'low\' }).then(/*...*/)\n<\/script>\n'})}),"\n",(0,r.jsx)(n.h3,{id:"images-lazy-loading",children:"Images Lazy Loading"}),"\n",(0,r.jsx)(n.p,{children:"Lazy Loading Polyfill:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:'<img data-src="flower.jpg" class="lazyload" />\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"window.addEventListener('scroll', (event) => {\n  Array.from(document.querySelectorAll('.lazyload')).forEach((image) => {\n    if (image.slideIntoView(event.getBoundingClientRect()))\n      image.setAttribute('src', image.dataset.src)\n  })\n})\n"})}),"\n",(0,r.jsx)(n.p,{children:"Observer Lazy Loading:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const observer = new IntersectionObserver((nodes) => {\n  nodes.forEach((v) => {\n    if (v.isIntersecting) {\n      v.target.src = v.target.dataset.src\n      observer.unobserve(v.target)\n    }\n  })\n})\n\nconst images = document.querySelectorAll('img.lazyload')\nimages.forEach(v => observer.observe(v))\n"})}),"\n",(0,r.jsx)(n.p,{children:"Native Lazy Loading:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:'<img src="flower.jpg" lazyload="auto" />\n<img src="flower.jpg" lazyload="on" />\n<img src="flower.jpg" lazyload="off" />\n'})}),"\n",(0,r.jsx)(n.h3,{id:"javascript-lazy-loading",children:"JavaScript Lazy Loading"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://addyosmani.com/blog/script-priorities",children:"Script Priorities"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"async"}),":\ndownloads script during parsing document,\nbut will ",(0,r.jsx)(n.strong,{children:"pause"})," parser to execute script."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"defer"}),":\ndownloads script during parsing document,\nand waits until document has finished parsing before executing it."]}),"\n",(0,r.jsxs)(n.li,{children:["If the script is independent, use ",(0,r.jsx)(n.code,{children:"async"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["If the scripts rely on each other, use ",(0,r.jsx)(n.code,{children:"defer"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["If put JavaScript in ",(0,r.jsx)(n.code,{children:"<head>"}),",\nin such script can't access DOM directly\n(DOM haven't get parsed)."]}),"\n",(0,r.jsxs)(n.li,{children:["Lazy loading scripts not execute immediately (",(0,r.jsx)(n.strong,{children:"Chrome coverage devtools"}),")."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://sia.codes/posts/render-blocking-resources/#deep-dive%3A-optimizing-javascript-for-the-critical-rendering-path",children:(0,r.jsx)(n.img,{alt:"Scripting Type",src:i(3005).A+"",width:"820",height:"200"})})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:'<script src="myScript.js"><\/script>\n<script src="myScript.js" async><\/script>\n<script src="myScript.js" defer><\/script>\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"const DetailsComponent = lazy(() => import('./details'))\n\nexport default function PageComponent() {\n  return (\n    <Suspense fallback={<div>Loading...</div>}>\n      <DetailsComponent />\n    </Suspense>\n  )\n}\n"})}),"\n",(0,r.jsx)(n.h4,{id:"script-lazy-loading",children:"Script Lazy Loading"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:"<html>\n  <body>\n    ... The full body of the page ...\n    <script>\n      window.onload = function () {\n        const script = document.createElement('script')\n        script.src = 'all_lazy_20100426.js'\n        script.async = true\n        document.documentElement.firstChild.appendChild(script)\n      }\n    <\/script>\n  </body>\n</html>\n"})}),"\n",(0,r.jsx)(n.h4,{id:"script-dynamic-loading",children:"Script Dynamic Loading"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"function requireScript(file, callback) {\n  const script = document.getElementsByTagName('script')[0]\n  const newJS = document.createElement('script')\n\n  // IE\n  newJS.onreadystatechange = function () {\n    if (newJS.readyState === 'loaded' || newJS.readyState === 'complete') {\n      newJS.onreadystatechange = null\n      callback()\n    }\n  }\n  // others\n  newJS.onload = function () {\n    callback()\n  }\n\n  // \u6dfb\u52a0\u81f3 HTML \u9875\u9762\n  newJS.src = file\n  newJS.async = true\n  script.parentNode.insertBefore(newJS, script)\n}\n\nrequireScript('the_rest.js', () => {\n  Application.init()\n})\n"})}),"\n",(0,r.jsx)(n.h4,{id:"babel-configuration",children:"Babel Configuration"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"modules"}),": always ",(0,r.jsx)(n.code,{children:"false"}),", keep ",(0,r.jsx)(n.code,{children:"esm"})," for bundler (e.g webpack) tree shaking."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"useBuiltIns"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"entry"}),": \u5c06 ",(0,r.jsx)(n.code,{children:"core-js import"})," \u66ff\u6362\u4e3a\u7279\u6027\u5217\u8868."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"usage"}),": \u6309\u4f7f\u7528\u5f15\u5165\u7528\u5230\u7684\u7279\u6027\u5217\u8868."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "presets": [\n    [\n      "@babel/preset-env",\n      {\n        "targets": {\n          "esmodules": true,\n          "node": ">= 8",\n          "browsers": "> 0.25%"\n        },\n        "modules": false,\n        "useBuiltIns": "usage"\n      }\n    ]\n  ]\n}\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:'<script type="module" src="main.mjs"><\/script>\n<script nomodule src="legacy.js"><\/script>\n'})}),"\n",(0,r.jsx)(n.h3,{id:"data-loading-best-practice",children:"Data Loading Best Practice"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u975e\u5fc5\u8981\u9759\u6001\u8d44\u6e90\u4e0a\u4f20 CDN: Client -> CDN Server -> CDN \u9aa8\u5e72\u7f51\u7edc (\u6781\u5ea6\u4f18\u5316) -> CDN Server -> Server."}),"\n",(0,r.jsx)(n.li,{children:"\u51b7\u542f\u52a8\u5f00\u542f\u6570\u636e\u9884\u62c9\u53d6."}),"\n",(0,r.jsx)(n.li,{children:"\u9875\u9762\u8def\u7531\u5207\u6362\u65f6\u8fdb\u884c\u6570\u636e\u9884\u62c9\u53d6 (\u5e76\u7f13\u5b58\u6570\u636e)."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"data-loading-reference",children:"Data Loading Reference"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Fetch priority ",(0,r.jsx)(n.a,{href:"https://web.dev/priority-hints",children:"guide"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Resources priority ",(0,r.jsx)(n.a,{href:"https://web.dev/prioritize-resources",children:"guide"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["3rd-party scripts loading ",(0,r.jsx)(n.a,{href:"https://www.patterns.dev/posts/third-party",children:"guide"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"performance-monitoring",children:"Performance Monitoring"}),"\n",(0,r.jsx)(n.p,{children:"\u524d\u7aef\u6027\u80fd\u76d1\u63a7\u5206\u4e3a\u4e24\u79cd\u65b9\u5f0f,\n\u4e00\u79cd\u53eb\u505a\u5408\u6210\u76d1\u63a7 (Synthetic Monitoring, SYN),\n\u53e6\u4e00\u79cd\u662f\u771f\u5b9e\u7528\u6237\u76d1\u63a7 (Real User Monitoring, RUM)."}),"\n",(0,r.jsx)(n.h3,{id:"synthetic-monitoring",children:"Synthetic Monitoring"}),"\n",(0,r.jsx)(n.p,{children:"\u5728\u4e00\u4e2a\u6a21\u62df\u573a\u666f\u91cc, \u53bb\u63d0\u4ea4\u4e00\u4e2a\u9700\u8981\u505a\u6027\u80fd\u5ba1\u8ba1\u7684\u9875\u9762,\n\u901a\u8fc7\u4e00\u7cfb\u5217\u7684\u5de5\u5177/\u89c4\u5219\u53bb\u8fd0\u884c\u4f60\u7684\u9875\u9762, \u63d0\u53d6\u4e00\u4e9b\u6027\u80fd\u6307\u6807, \u5f97\u51fa\u4e00\u4e2a\u5ba1\u8ba1\u62a5\u544a."}),"\n",(0,r.jsx)(n.p,{children:"\u5e38\u89c1\u7684\u5de5\u5177\u6709 Google \u7684 Lighthouse, WebPageTest, PageSpeed \u7b49"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"\u4f18\u70b9"}),(0,r.jsx)(n.th,{style:{textAlign:"center"},children:"\u7f3a\u70b9"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"\u5b9e\u73b0\u7b80\u5355"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u65e0\u6cd5\u8fd8\u539f\u5168\u90e8\u771f\u5b9e\u573a\u666f"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"\u80fd\u91c7\u96c6\u5230\u4e30\u5bcc\u7684\u6570\u636e, \u5982\u786c\u4ef6\u6307\u6807\u6216\u7011\u5e03\u56fe"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u767b\u5f55\u7b49\u573a\u666f\u9700\u8981\u989d\u5916\u89e3\u51b3"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"\u4e0d\u5f71\u54cd\u771f\u5b9e\u7528\u6237\u7684\u8bbf\u95ee\u6027\u80fd"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u5355\u6b21\u6570\u636e\u4e0d\u591f\u7a33\u5b9a"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"\u53ef\u4ee5\u63d0\u4f9b\u9875\u9762\u52a0\u8f7d\u5e7b\u706f\u7247\u7b49\u53ef\u89c6\u5316\u5206\u6790\u9014\u5f84"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u6570\u636e\u91cf\u8f83\u5c0f, \u65e0\u6cd5\u53d1\u6325\u66f4\u5927\u4ef7\u503c"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"real-user-monitoring",children:"Real User Monitoring"}),"\n",(0,r.jsx)(n.p,{children:"\u7528\u6237\u5728\u9875\u9762\u8bbf\u95ee\u4e4b\u540e\u5c31\u4f1a\u4ea7\u751f\u5404\u79cd\u5404\u6837\u7684\u6027\u80fd\u6307\u6807,\n\u4e4b\u540e\u4f1a\u5c06\u8fd9\u4e9b\u6027\u80fd\u6307\u6807\u4e0a\u4f20\u7684\u6211\u4eec\u7684\u65e5\u5fd7\u670d\u52a1\u5668\u4e0a,\n\u8fdb\u884c\u6570\u636e\u7684\u63d0\u8d77\u6e05\u6d17\u52a0\u5de5,\n\u6700\u540e\u5728\u76d1\u63a7\u5e73\u53f0\u4e0a\u8fdb\u884c\u5c55\u793a\u548c\u5206\u6790\u7684\u4e00\u4e2a\u8fc7\u7a0b."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u771f\u5b9e\u7528\u6237\u76d1\u63a7\u7684\u4f18\u7f3a\u70b9"}),"\n"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"\u4f18\u70b9"}),(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"\u7f3a\u70b9"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"\u65e0\u9700\u914d\u7f6e\u6a21\u62df\u6761\u4ef6, \u5b8c\u5168\u8fd8\u539f\u771f\u5b9e\u573a\u666f"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"\u5f71\u54cd\u771f\u5b9e\u7528\u6237\u7684\u8bbf\u95ee\u6027\u80fd\u53ca\u6d41\u91cf\u6d88\u8017"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"\u4e0d\u5b58\u5728\u767b\u5f55\u7b49\u9700\u8981\u989d\u5916\u89e3\u51b3\u7684\u573a\u666f"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"\u65e0\u6cd5\u91c7\u96c6\u786c\u4ef6\u76f8\u5173\u6307\u6807"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"\u6570\u636e\u6837\u672c\u8db3\u591f\u5e9e\u5927, \u53ef\u4ee5\u51cf\u5c11\u7edf\u8ba1\u8bef\u5dee"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"\u65e0\u6cd5\u91c7\u96c6\u5b8c\u6574\u7684\u8d44\u6e90\u52a0\u8f7d\u7011\u5e03\u56fe"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"\u65b0\u5e74\u6570\u636e\u53ef\u4e0e\u5176\u5b83\u6570\u636e\u5173\u8054, \u4ea7\u751f\u66f4\u5927\u4ef7\u503c"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"\u65e0\u6cd5\u53ef\u89c6\u5316\u5c55\u793a\u52a0\u8f7d\u8fc7\u7a0b"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"syn-and-rum",children:"SYN and RUM"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"\u5bf9\u6bd4\u9879"}),(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"\u5408\u6210\u76d1\u63a7"}),(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"\u771f\u5b9e\u7528\u6237\u76d1\u63a7"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"\u5b9e\u73b0\u96be\u5ea6\u53ca\u6210\u672c"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"\u8f83\u4f4e"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"\u8f83\u9ad8"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"\u91c7\u96c6\u6570\u636e\u4e30\u5bcc\u5ea6"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"\u4e30\u5bcc"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"\u57fa\u7840"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"\u6570\u636e\u6837\u672c\u91cf"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"\u8f83\u5c0f"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"\u5927(\u89c6\u4e1a\u52a1\u4f53\u91cf)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"\u9002\u5408\u573a\u666f"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"\u5b9a\u6027\u5206\u6790, \u5c0f\u6570\u636e\u91cf\u5206\u6790"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"\u5b9a\u91cf\u5206\u6790, \u4e1a\u52a1\u6570\u636e\u6df1\u5ea6\u6316\u6398"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"monitoring-methods",children:"Monitoring Methods"}),"\n",(0,r.jsx)(n.p,{children:"\u5728\u771f\u5b9e\u7528\u6237\u6027\u80fd\u6570\u636e\u91c7\u96c6\u65f6, \u8981\u5173\u6ce8\u56db\u4e2a\u65b9\u9762\u7684\u4e1c\u897f:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u4f7f\u7528\u6807\u51c6\u7684 API."}),"\n",(0,r.jsx)(n.li,{children:"\u5b9a\u4e49\u5408\u9002\u7684\u6307\u6807."}),"\n",(0,r.jsx)(n.li,{children:"\u91c7\u96c6\u6b63\u786e\u7684\u6570\u636e."}),"\n",(0,r.jsx)(n.li,{children:"\u4e0a\u62a5\u5173\u8054\u7684\u7ef4\u5ea6."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"monitoring-standard-api",children:"Monitoring Standard API"}),"\n",(0,r.jsx)(n.p,{children:"\u91c7\u96c6\u6027\u80fd\u6570\u636e\u65f6\u5148\u62b9\u5e73 Navigation Timing spec \u5dee\u5f02\n\u4f18\u5148\u4f7f\u7528 PerformanceTimeline API\n(\u5728\u590d\u6742\u573a\u666f, \u4ea6\u53ef\u8003\u8651\u4f18\u5148\u4f7f\u7528 PerformanceObserver):"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u91cd\u5b9a\u5411\u8017\u65f6 = redirectEnd - redirectStart."}),"\n",(0,r.jsx)(n.li,{children:"DNS \u67e5\u8be2\u8017\u65f6 = domainLookupEnd - domainLookupStart."}),"\n",(0,r.jsx)(n.li,{children:"TCP \u94fe\u63a5\u8017\u65f6 = connectEnd - connectStart."}),"\n",(0,r.jsx)(n.li,{children:"HTTP \u8bf7\u6c42\u8017\u65f6 = responseEnd - responseStart."}),"\n",(0,r.jsx)(n.li,{children:"\u89e3\u6790 DOM \u6811\u8017\u65f6 = domComplete - domInteractive."}),"\n",(0,r.jsx)(n.li,{children:"\u767d\u5c4f\u65f6\u95f4 = responseStart - navigationStart."}),"\n",(0,r.jsx)(n.li,{children:"DOMReady \u65f6\u95f4 = domContentLoadedEventEnd - navigationStart."}),"\n",(0,r.jsx)(n.li,{children:"onload \u65f6\u95f4 = loadEventEnd - navigationStart."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"monitoring-statistics-data",children:"Monitoring Statistics Data"}),"\n",(0,r.jsx)(n.p,{children:"First Meaningful Paint: \u9996\u6b21\u6709\u6548\u6e32\u67d3\u65f6\u957f,\n\u5b83\u7684\u4e00\u4e2a\u6838\u5fc3\u7684\u60f3\u6cd5\u662f\u6e32\u67d3\u5e76\u4e0d\u4e00\u5b9a\u4ee3\u8868\u7740\u7528\u6237\u770b\u5230\u4e86\u4e3b\u8981\u5185\u5bb9,\nLoad \u4e5f\u4e0d\u4e00\u5b9a\u4ee3\u8868\u7528\u6237\u770b\u5230\u4e3b\u8981\u5185\u5bb9.\n\u5047\u8bbe\u5f53\u4e00\u4e2a\u7f51\u9875\u7684 DOM \u7ed3\u6784\u53d1\u751f\u5267\u70c8\u7684\u53d8\u5316\u7684\u65f6\u5019,\n\u5c31\u662f\u8fd9\u4e2a\u7f51\u9875\u4e3b\u8981\u5185\u5bb9\u51fa\u73b0\u7684\u65f6\u5019,\n\u90a3\u4e48\u5728\u8fd9\u6837\u7684\u4e00\u4e2a\u65f6\u95f4\u70b9\u4e0a,\n\u5c31\u662f\u7528\u6237\u770b\u5230\u4e3b\u8981\u5185\u5bb9\u7684\u4e00\u4e2a\u65f6\u95f4\u70b9."}),"\n",(0,r.jsx)(n.p,{children:"\u5b83\u7684\u4f18\u70b9\u662f\u76f8\u5bf9\u6821\u51c6\u7684\u4f30\u7b97\u51fa\u5185\u5bb9\u6e32\u67d3\u65f6\u95f4, \u8d34\u8fd1\u7528\u6237\u611f\u77e5.\n\u4f46\u7f3a\u70b9\u662f\u65e0\u539f\u751f API \u652f\u6301, \u7b97\u6cd5\u63a8\u5bfc\u65f6 DOM \u8282\u70b9\u542b\u6743\u91cd."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"First Paint (FP): 0 ~ 1 ~ 2.5s."}),"\n",(0,r.jsx)(n.li,{children:"First Meaningful Paint (FMP)"}),"\n",(0,r.jsx)(n.li,{children:"First Contentful Paint (FCP): 0 ~ 2 ~ 4s."}),"\n",(0,r.jsx)(n.li,{children:"Largest Contentful Paint (LCP): 0 ~ 2.5 ~ 4s."}),"\n",(0,r.jsx)(n.li,{children:"Interaction to Next Paint (INP): 0 ~ 0.2 ~ 0.5s."}),"\n",(0,r.jsx)(n.li,{children:"Cumulative Layout Shift (CLS): 0 ~ 0.1 ~ 0.25."}),"\n",(0,r.jsx)(n.li,{children:"Time to Interactive (TTI): 0 ~ 3.8 ~ 7.3s."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"monitoring-report-dimension",children:"Monitoring Report Dimension"}),"\n",(0,r.jsx)(n.p,{children:"\u4e0d\u540c\u7684\u9875\u9762\u64cd\u4f5c/\u9875\u9762\u6253\u5f00\u65b9\u5f0f/\u6d4f\u89c8\u5668\u73af\u5883\u90fd\u4f1a\u5bf9\u6211\u4eec\u9875\u9762\u52a0\u8f7d\u7684\u6027\u80fd\u4f1a\u6709\u5f71\u54cd,\n\u9700\u8981\u4e0a\u62a5\u8fd9\u4e9b\u7ef4\u5ea6\u7684\u6570\u636e, \u4ee5\u4fbf\u6df1\u5165\u6027\u80fd\u5206\u6790:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u5f53\u524d\u9875\u9762\u662f\u5426\u53ef\u89c1."}),"\n",(0,r.jsx)(n.li,{children:"\u9875\u9762\u52a0\u8f7d\u65b9\u5f0f: \u76f4\u63a5\u6253\u5f00/\u5237\u65b0\u6253\u5f00/\u524d\u8fdb\u540e\u9000\u6253\u5f00."}),"\n",(0,r.jsx)(n.li,{children:"\u662f\u5426\u542f\u7528 HTTP2."}),"\n",(0,r.jsx)(n.li,{children:"\u662f\u5426\u542f\u7528 Service Worker."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"monitoring-report-performance",children:"Monitoring Report Performance"}),"\n",(0,r.jsx)(n.p,{children:"\u89e3\u51b3\u4e0a\u62a5\u5bf9\u6027\u80fd\u7684\u5f71\u54cd\u95ee\u9898\u6709\u4ee5\u4e0b\u65b9\u6848:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u5ef6\u8fdf\u5408\u5e76\u4e0a\u62a5: \u5ef6\u8fdf\u5230 ",(0,r.jsx)(n.code,{children:"onload"})," \u4e8b\u4ef6\u540e, \u5e76\u5408\u5e76\u591a\u4e2a\u4e0a\u62a5\u8bf7\u6c42."]}),"\n",(0,r.jsxs)(n.li,{children:["\u4f7f\u7528 ",(0,r.jsx)(n.a,{href:"https://developer.mozilla.org/docs/Web/API/Beacon_API",children:"Beacon API"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Sent reliably (even if page unload)."}),"\n",(0,r.jsx)(n.li,{children:"Sent asynchronously."}),"\n",(0,r.jsx)(n.li,{children:"Not impact loading of next page."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\u4f7f\u7528 ",(0,r.jsx)(n.code,{children:"post"})," \u4e0a\u62a5."]}),"\n",(0,r.jsxs)(n.li,{children:["Prefer ",(0,r.jsx)(n.code,{children:"visibilitychange"}),"/",(0,r.jsx)(n.code,{children:"pagehide"})," event.\n",(0,r.jsx)(n.code,{children:"unload"}),"/",(0,r.jsx)(n.code,{children:"beforeunload"})," event not precise for mobile users:\ne.g switch to another app not trigger ",(0,r.jsx)(n.code,{children:"unload"})," event."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"document.addEventListener('DOMContentLoaded', () => {\n  console.log('DOM \u6302\u8f7d\u65f6\u95f4: ', Date.now() - timerStart)\n\n  // \u6027\u80fd\u65e5\u5fd7\u4e0a\u62a5...\n})\n\nwindow.addEventListener('load', () => {\n  console.log('\u6240\u6709\u8d44\u6e90\u52a0\u8f7d\u5b8c\u6210\u65f6\u95f4: ', Date.now() - timerStart)\n\n  // \u6027\u80fd\u65e5\u5fd7\u4e0a\u62a5...\n})\n\ndocument.addEventListener('visibilitychange', () => {\n  if (document.visibilityState === 'hidden') {\n    const obj = { user: 1 }\n    const blob = new Blob([JSON.stringify(obj, null, 2)], {\n      type: 'application/json',\n    })\n    navigator.sendBeacon('/log', blob)\n  }\n})\n"})}),"\n",(0,r.jsx)(n.h3,{id:"gif-image-beacon",children:"GIF Image Beacon"}),"\n",(0,r.jsxs)(n.p,{children:["\u4f7f\u7528 ",(0,r.jsx)(n.code,{children:"GIF"})," \u56fe\u7247\u8fdb\u884c\u524d\u7aef\u76d1\u63a7\u4e0a\u62a5:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u8de8\u57df\u53cb\u597d: ",(0,r.jsx)(n.code,{children:"img"})," \u5929\u7136\u652f\u6301\u8de8\u57df."]}),"\n",(0,r.jsxs)(n.li,{children:["\u8282\u7701\u7f51\u7edc\u8d44\u6e90:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u56fe\u7247\u8bf7\u6c42\u4e0d\u5360\u7528 AJAX \u8bf7\u6c42\u9650\u989d."}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"GIF"})," \u7b80\u5355\u5b89\u5168, \u4f53\u79ef\u5c0f, \u5bf9\u7f51\u9875\u5185\u5bb9\u51e0\u4e4e\u65e0\u5f71\u54cd,\n\u76f8\u8f83 ",(0,r.jsx)(n.code,{children:"BMP"}),"/",(0,r.jsx)(n.code,{children:"PNG"}),", \u53ef\u4ee5\u8282\u7ea6 ",(0,r.jsx)(n.code,{children:"41%"}),"/",(0,r.jsx)(n.code,{children:"35%"})," \u7f51\u7edc\u8d44\u6e90."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\u4e0d\u4f1a\u963b\u585e\u9875\u9762\u52a0\u8f7d, \u4e0d\u5f71\u54cd\u7528\u6237\u4f53\u9a8c:\n\u53ea\u9700 ",(0,r.jsx)(n.code,{children:"new Image()"})," \u5bf9\u8c61,\n\u901a\u8fc7 ",(0,r.jsx)(n.code,{children:"onerror"})," \u548c ",(0,r.jsx)(n.code,{children:"onload"})," \u4e8b\u4ef6\u6765\u68c0\u6d4b\u53d1\u9001\u72b6\u6001,\n\u4e00\u822c\u60c5\u51b5\u4e0b\u65e0\u9700 ",(0,r.jsx)(n.code,{children:"append"})," \u5230 ",(0,r.jsx)(n.code,{children:"DOM"})," \u4e2d."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const thisPage = window.location.href\nconst referringPage = document.referrer ? document.referrer : 'none'\nconst beacon = new Image()\nbeacon.src = `http://www.example.com/logger/beacon.gif?page=${encodeURI(\n  thisPage,\n)}&ref=${encodeURI(referringPage)}`\n"})}),"\n",(0,r.jsx)(n.h3,{id:"performance-monitoring-reference",children:"Performance Monitoring Reference"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Performance monitoring data collection and report ",(0,r.jsx)(n.a,{href:"https://zhuanlan.zhihu.com/p/420330110",children:"case"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Performance monitoring real world ",(0,r.jsx)(n.a,{href:"https://juejin.cn/post/7078512301665419295",children:"case"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Dangerous performance cheating ",(0,r.jsx)(n.a,{href:"https://performance.shopify.com/blogs/blog/don-t-get-scammed-by-fake-performance-experts-and-apps",children:"hacks"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"web-vitals",children:"Web Vitals"}),"\n",(0,r.jsx)(n.h3,{id:"web-performance-api",children:"Web Performance API"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"performance.mark('mainThread-start')\nexpensiveCalculation()\nperformance.mark('mainThread-stop')\nperformance.measure('mainThread', 'mainThread-start', 'mainThread-stop')\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"// \u8ba1\u7b97\u52a0\u8f7d\u65f6\u95f4.\nfunction getPerformanceTiming() {\n  const performance = window.performance\n\n  if (!performance) {\n    // \u5f53\u524d\u6d4f\u89c8\u5668\u4e0d\u652f\u6301.\n    console.log('\u4f60\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301 performance \u63a5\u53e3')\n    return\n  }\n\n  const t = performance.timing\n  const times = {}\n\n  // \u3010\u91cd\u8981\u3011\u9875\u9762\u52a0\u8f7d\u5b8c\u6210\u7684\u65f6\u95f4.\n  // \u3010\u539f\u56e0\u3011\u51e0\u4e4e\u4ee3\u8868\u4e86\u7528\u6237\u7b49\u5f85\u9875\u9762\u53ef\u7528\u7684\u65f6\u95f4.\n  times.loadPage = t.loadEventEnd - t.navigationStart\n\n  // \u3010\u91cd\u8981\u3011\u89e3\u6790 DOM \u6811\u7ed3\u6784\u7684\u65f6\u95f4.\n  // \u3010\u539f\u56e0\u3011DOM \u6811\u5d4c\u5957\u8fc7\u591a.\n  times.domReady = t.domComplete - t.responseEnd\n\n  // \u3010\u91cd\u8981\u3011\u91cd\u5b9a\u5411\u7684\u65f6\u95f4.\n  // \u3010\u539f\u56e0\u3011\u62d2\u7edd\u91cd\u5b9a\u5411. e.g http://example.com/ \u4e0d\u5e94\u5199\u6210 http://example.com.\n  times.redirect = t.redirectEnd - t.redirectStart\n\n  // \u3010\u91cd\u8981\u3011DNS \u67e5\u8be2\u65f6\u95f4.\n  // \u3010\u539f\u56e0\u3011DNS \u9884\u52a0\u8f7d\u505a\u4e86\u4e48? \u9875\u9762\u5185\u662f\u4e0d\u662f\u4f7f\u7528\u4e86\u592a\u591a\u4e0d\u540c\u7684\u57df\u540d\u5bfc\u81f4\u57df\u540d\u67e5\u8be2\u7684\u65f6\u95f4\u592a\u957f?\n  // \u53ef\u4f7f\u7528 HTML5 Prefetch \u9884\u67e5\u8be2 DNS, \u89c1: [HTML5 prefetch](http://segmentfault.com/a/1190000000633364).\n  times.lookupDomain = t.domainLookupEnd - t.domainLookupStart\n\n  // \u3010\u91cd\u8981\u3011\u8bfb\u53d6\u9875\u9762\u7b2c\u4e00\u4e2a\u5b57\u8282\u7684\u65f6\u95f4.\n  // \u3010\u539f\u56e0\u3011\u8fd9\u53ef\u4ee5\u7406\u89e3\u4e3a\u7528\u6237\u62ff\u5230\u4f60\u7684\u8d44\u6e90\u5360\u7528\u7684\u65f6\u95f4, \u52a0\u5f02\u5730\u673a\u623f\u4e86\u4e48, \u52a0CDN \u5904\u7406\u4e86\u4e48? \u52a0\u5e26\u5bbd\u4e86\u4e48? \u52a0 CPU \u8fd0\u7b97\u901f\u5ea6\u4e86\u4e48?\n  // TTFB \u5373 Time To First Byte \u7684\u610f\u601d.\n  // \u7ef4\u57fa\u767e\u79d1: https://en.wikipedia.org/wiki/Time_To_First_Byte.\n  times.ttfb = t.responseStart - t.navigationStart\n\n  // \u3010\u91cd\u8981\u3011\u5185\u5bb9\u52a0\u8f7d\u5b8c\u6210\u7684\u65f6\u95f4.\n  // \u3010\u539f\u56e0\u3011\u9875\u9762\u5185\u5bb9\u7ecf\u8fc7 gzip \u538b\u7f29\u4e86\u4e48, \u9759\u6001\u8d44\u6e90 `CSS`/`JS` \u7b49\u538b\u7f29\u4e86\u4e48?\n  times.request = t.responseEnd - t.requestStart\n\n  // \u3010\u91cd\u8981\u3011\u6267\u884c onload \u56de\u8c03\u51fd\u6570\u7684\u65f6\u95f4.\n  // \u3010\u539f\u56e0\u3011\u662f\u5426\u592a\u591a\u4e0d\u5fc5\u8981\u7684\u64cd\u4f5c\u90fd\u653e\u5230 onload \u56de\u8c03\u51fd\u6570\u91cc\u6267\u884c\u4e86, \u8003\u8651\u8fc7\u5ef6\u8fdf\u52a0\u8f7d/\u6309\u9700\u52a0\u8f7d\u7684\u7b56\u7565\u4e48?\n  times.loadEvent = t.loadEventEnd - t.loadEventStart\n\n  // DNS \u7f13\u5b58\u65f6\u95f4.\n  times.appCache = t.domainLookupStart - t.fetchStart\n\n  // \u5378\u8f7d\u9875\u9762\u7684\u65f6\u95f4.\n  times.unloadEvent = t.unloadEventEnd - t.unloadEventStart\n\n  // TCP \u5efa\u7acb\u8fde\u63a5\u5b8c\u6210\u63e1\u624b\u7684\u65f6\u95f4.\n  times.connect = t.connectEnd - t.connectStart\n  return times\n}\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const [pageNav] = performance.getEntriesByType('navigation')\n\n// Measuring DNS lookup time.\nconst totalLookupTime = pageNav.domainLookupEnd - pageNav.domainLookupStart\n\n// Quantifying total connection time.\nconst connectionTime = pageNav.connectEnd - pageNav.connectStart\nlet tlsTime = 0 // <-- Assume 0 to start with\n\n// Was there TLS negotiation?\nif (pageNav.secureConnectionStart > 0) {\n  // Awesome! Calculate it!\n  tlsTime = pageNav.connectEnd - pageNav.secureConnectionStart\n}\n\n// Cache seek plus response time of the current document.\nconst fetchTime = pageNav.responseEnd - pageNav.fetchStart\n\n// Service worker time plus response time.\nlet workerTime = 0\n\nif (pageNav.workerStart > 0)\n  workerTime = pageNav.responseEnd - pageNav.workerStart\n\n// Request time only (excluding redirects, DNS, and connection/TLS time).\nconst requestTime = pageNav.responseStart - pageNav.requestStart\n\n// Response time only (download).\nconst responseTime = pageNav.responseEnd - pageNav.responseStart\n\n// Request + response time.\nconst requestResponseTime = pageNav.responseEnd - pageNav.requestStart\n"})}),"\n",(0,r.jsx)(n.h3,{id:"fp",children:"FP"}),"\n",(0,r.jsx)(n.p,{children:"First paint time:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"function entryHandler(list) {\n  for (const entry of list.getEntries()) {\n    if (entry.name === 'first-paint')\n      observer.disconnect()\n\n    console.log(entry)\n  }\n}\n\nconst observer = new PerformanceObserver(entryHandler)\nobserver.observe({ type: 'paint', buffered: true })\n\n// {\n//   duration: 0,\n//   entryType: \"paint\",\n//   name: \"first-paint\",\n//   startTime: 359,\n// }\n"})}),"\n",(0,r.jsx)(n.h3,{id:"fcp",children:"FCP"}),"\n",(0,r.jsx)(n.p,{children:"First Contentful Paint:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Add the ",(0,r.jsx)(n.code,{children:"defer"})," or ",(0,r.jsx)(n.code,{children:"async"})," attributes to ",(0,r.jsx)(n.code,{children:"<script>"})," tags."]}),"\n",(0,r.jsx)(n.li,{children:"Minify the JavaScript and CSS files."}),"\n",(0,r.jsx)(n.li,{children:"Remove unused CSS (e.g Tailwind.css JIT mode)."}),"\n",(0,r.jsx)(n.li,{children:"Lazy importing components not for first page."}),"\n",(0,r.jsx)(n.li,{children:"Server side rendering."}),"\n",(0,r.jsx)(n.li,{children:"Reduce server response time (e.g CDN)."}),"\n",(0,r.jsx)(n.li,{children:"TBT (Total Blocking Time) = TTI (Time to Interactive) - FCP (First Contentful Paint)."}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"function entryHandler(list) {\n  for (const entry of list.getEntries()) {\n    if (entry.name === 'first-contentful-paint')\n      observer.disconnect()\n\n    console.log(entry)\n  }\n}\n\nconst observer = new PerformanceObserver(entryHandler)\nobserver.observe({ type: 'paint', buffered: true })\n\n// {\n//   duration: 0,\n//   entryType: \"paint\",\n//   name: \"first-contentful-paint\",\n//   startTime: 459,\n// }\n"})}),"\n",(0,r.jsx)(n.h3,{id:"lcp",children:"LCP"}),"\n",(0,r.jsx)(n.p,{children:"Largest Contentful Paint:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Use a CDN for assets like images and video."}),"\n",(0,r.jsxs)(n.li,{children:["Compress images:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Minify images."}),"\n",(0,r.jsx)(n.li,{children:"Convert images from JPEG/PNG to WebP."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Responsive images:\nsize image based on device size with ",(0,r.jsx)(n.code,{children:"srcset"})," on ",(0,r.jsx)(n.code,{children:"<img>"})," or ",(0,r.jsx)(n.code,{children:"<picture>"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["\u6e10\u8fdb\u6e32\u67d3\u662f\u63d0\u9ad8 ",(0,r.jsx)(n.code,{children:"SpeedIndex"})," \u5173\u952e: \u7ed3\u5408 ",(0,r.jsx)(n.code,{children:"Suspense"})," \u4f18\u5148\u6e32\u67d3\u5df2\u51c6\u5907\u597d\u7684\u89c6\u56fe, \u6e10\u8fdb\u6e32\u67d3\u7b49\u5f85\u6570\u636e\u7684\u89c6\u56fe."]}),"\n",(0,r.jsxs)(n.li,{children:["LCP optimization ",(0,r.jsx)(n.a,{href:"https://calibreapp.com/blog/largest-contentful-paint",children:"checklist"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["LCP optimization ",(0,r.jsx)(n.a,{href:"https://csswizardry.com/2022/03/optimising-largest-contentful-paint",children:"guide"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"function entryHandler(list) {\n  if (observer)\n    observer.disconnect()\n\n  for (const entry of list.getEntries())\n    console.log(entry)\n}\n\nconst observer = new PerformanceObserver(entryHandler)\nobserver.observe({ type: 'largest-contentful-paint', buffered: true })\n\n// {\n//   duration: 0,\n//   element: p,\n//   entryType: 'largest-contentful-paint',\n//   id: '',\n//   loadTime: 0,\n//   name: '',\n//   renderTime: 1021.299,\n//   size: 37932,\n//   startTime: 1021.299,\n//   url: '',\n// }\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Emulate slow third-party resources with ",(0,r.jsx)(n.a,{href:"https://www.checklyhq.com/blog/how-playwright-can-monitor-third-party-resources",children:"Playwright"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"import { expect, test } from '@playwright/test'\n\ntest('works with slows resources', async ({ page }) => {\n  page.route(\n    '**',\n    route =>\n      new Promise((resolve) => {\n        const requestURL = route.request().url()\n\n        if (requestURL.match(/http:\\/\\/localhost:8080/)) {\n          resolve(route.continue())\n        } else {\n          setTimeout(() => {\n            console.log(`Delaying ${requestURL}`)\n            resolve(route.continue())\n          }, 10000)\n        }\n      }),\n  )\n  await page.goto('http://localhost:8080')\n\n  const largestContentfulPaint = await page.evaluate(() => {\n    return new Promise((resolve) => {\n      new PerformanceObserver((l) => {\n        const entries = l.getEntries()\n        // the last entry is the largest contentful paint\n        const largestPaintEntry = entries.at(-1)\n        resolve(largestPaintEntry.startTime)\n      }).observe({\n        type: 'largest-contentful-paint',\n        buffered: true,\n      })\n    })\n  })\n\n  console.log(`CLP: ${Number.parseFloat(largestContentfulPaint)}ms`)\n\n  // Expect a title \"to contain\" a substring.\n  await expect(page).toHaveTitle(/Frontend downtime/)\n})\n"})}),"\n",(0,r.jsx)(n.h3,{id:"inp",children:"INP"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://frontendmasters.com/blog/understanding-inp",children:(0,r.jsx)(n.img,{alt:"Interaction to Next Paint",src:i(9754).A+"",width:"2048",height:"334"})})}),"\n",(0,r.jsxs)(n.p,{children:["Interaction to Next Paint (INP) \u5df2\u53d6\u4ee3 FID,\n",(0,r.jsx)(n.a,{href:"https://web.dev/blog/inp-cwv-launch",children:"\u6210\u4e3a Core Web Vitals \u7684\u4e00\u90e8\u5206"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"It considers the time between user's interaction and the next paint."}),"\n",(0,r.jsx)(n.li,{children:"Input delay: callback queue blocked by other higher priority tasks."}),"\n",(0,r.jsx)(n.li,{children:"Processing time: event handler execution time."}),"\n",(0,r.jsx)(n.li,{children:"Presentation delay: rendering and compositing time."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Improve INP for Vanilla.js:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Reduce:\n\u51cf\u5c11\u4e0d\u5fc5\u8981\u7684\u4ee3\u7801,\ne.g Useless polyfills, redundant animation and transition effects."}),"\n",(0,r.jsxs)(n.li,{children:["Defer:\n\u63a8\u8fdf\u4e0d\u9700\u8981\u5728\u4e0b\u4e00\u4e2a\u7ed8\u5236\u4e4b\u524d\u8fd0\u884c\u7684\u4ee3\u7801,\ne.g Lazy loading, code splitting,\ndefer irrelevant expensive calculations (",(0,r.jsx)(n.code,{children:"requestIdleCallback()"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["Optimize:\n\u4f18\u5316\u5fc5\u987b\u5728\u4e0b\u4e00\u4e2a\u7ed8\u5236\u4e4b\u524d\u8fd0\u884c\u7684\u4ee3\u7801,\ne.g Debounce, throttle, virtualized Window, time slicing (",(0,r.jsx)(n.code,{children:"yieldToMain()"}),")."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Improve INP in ",(0,r.jsx)(n.a,{href:"https://www.thisdot.co/blog/improving-inp-in-react-and-next-js",children:"Next.js"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Concurrent rendering with ",(0,r.jsx)(n.code,{children:"useTransition"})," hook."]}),"\n",(0,r.jsx)(n.li,{children:"Leverage automatic batching."}),"\n",(0,r.jsxs)(n.li,{children:["Selective hydration ",(0,r.jsx)(n.a,{href:"https://www.patterns.dev/react/react-selective-hydration",children:"pattern"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"Leverage SSG and ISR for static content."}),"\n",(0,r.jsxs)(n.li,{children:["Offloading heavy computations to ",(0,r.jsx)(n.a,{href:"https://partytown.builder.io/nextjs",children:"Web Workers"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Prevent unnecessary re-renders with ",(0,r.jsx)(n.code,{children:"Forget Compiler"})," and state management library."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"cls",children:"CLS"}),"\n",(0,r.jsx)(n.p,{children:"Cumulative Layout Shift:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Set ",(0,r.jsx)(n.code,{children:"height"})," and ",(0,r.jsx)(n.code,{children:"width"})," attributes of image or video,\nso that it won\u2019t move content around it once it\u2019s loaded."]}),"\n",(0,r.jsxs)(n.li,{children:["Avoid using ",(0,r.jsx)(n.code,{children:"popups"})," or ",(0,r.jsx)(n.code,{children:"overlays"}),"\nunless they appear when the user interacts with the page."]}),"\n",(0,r.jsxs)(n.li,{children:["When it\u2019s necessary to move elements, use ",(0,r.jsx)(n.code,{children:"transform"})," animations."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"let sessionValue = 0\nlet sessionEntries = []\nconst cls = {\n  subType: 'layout-shift',\n  name: 'layout-shift',\n  type: 'performance',\n  pageURL: getPageURL(),\n  value: 0,\n}\n\nfunction entryHandler(list) {\n  for (const entry of list.getEntries()) {\n    // Only count layout shifts without recent user input.\n    if (!entry.hadRecentInput) {\n      const firstSessionEntry = sessionEntries[0]\n      const lastSessionEntry = sessionEntries[sessionEntries.length - 1]\n\n      // If the entry occurred less than 1 second after the previous entry and\n      // less than 5 seconds after the first entry in the session, include the\n      // entry in the current session. Otherwise, start a new session.\n      if (\n        sessionValue\n        && entry.startTime - lastSessionEntry.startTime < 1000\n        && entry.startTime - firstSessionEntry.startTime < 5000\n      ) {\n        sessionValue += entry.value\n        sessionEntries.push(formatCLSEntry(entry))\n      } else {\n        sessionValue = entry.value\n        sessionEntries = [formatCLSEntry(entry)]\n      }\n\n      // If the current session value is larger than the current CLS value,\n      // update CLS and the entries contributing to it.\n      if (sessionValue > cls.value) {\n        cls.value = sessionValue\n        cls.entries = sessionEntries\n        cls.startTime = performance.now()\n        lazyReportCache(deepCopy(cls))\n      }\n    }\n  }\n}\n\nconst observer = new PerformanceObserver(entryHandler)\nobserver.observe({ type: 'layout-shift', buffered: true })\n\n// {\n//   duration: 0,\n//   entryType: \"layout-shift\",\n//   hadRecentInput: false,\n//   lastInputTime: 0,\n//   name: \"\",\n//   sources: (2) [LayoutShiftAttribution, LayoutShiftAttribution],\n//   startTime: 1176.199999999255,\n//   value: 0.000005752046026677329,\n// }\n"})}),"\n",(0,r.jsx)(n.h3,{id:"core-web-vitals",children:"Core Web Vitals"}),"\n",(0,r.jsxs)(n.p,{children:["Google ",(0,r.jsx)(n.a,{href:"https://web.dev/articles/vitals",children:"Core Web Vitals"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u52a0\u8f7d (Loading): LCP."}),"\n",(0,r.jsx)(n.li,{children:"\u4ea4\u4e92 (Interactivity): INP."}),"\n",(0,r.jsx)(n.li,{children:"\u89c6\u89c9\u7a33\u5b9a (Visual Stability): CLS."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"web-vitals-reference",children:"Web Vitals Reference"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["LCP optimization ",(0,r.jsx)(n.a,{href:"https://web.dev/optimize-lcp",children:"guide"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["INP optimization ",(0,r.jsx)(n.a,{href:"https://web.dev/explore/how-to-optimize-inp",children:"guide"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["CLS optimization ",(0,r.jsx)(n.a,{href:"https://web.dev/optimize-cls",children:"guide"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Web latency ",(0,r.jsx)(n.a,{href:"https://vercel.com/blog/latency-numbers-every-web-developer-should-know",children:"guide"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Web vitals measurement ",(0,r.jsx)(n.a,{href:"https://web.dev/vitals-field-measurement-best-practices",children:"best practices"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Web vitals field data debugging ",(0,r.jsx)(n.a,{href:"https://web.dev/debug-web-vitals-in-the-field",children:"guide"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Web vitals real world ",(0,r.jsx)(n.a,{href:"https://mp.weixin.qq.com/s/zJMM4SF7pc6LZPCsQfWOxw",children:"case"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"prpl-pattern",children:"PRPL Pattern"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"PRPL"})," pattern focuses on 4 main performance considerations:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Pushing critical resources efficiently:\nminimize amount of round trips to server and reducing loading time."}),"\n",(0,r.jsx)(n.li,{children:"Rendering initial route soon as possible:\nimprove user experience."}),"\n",(0,r.jsx)(n.li,{children:"Pre-caching assets in the background for frequently visited routes:\nminimize amount of requests to server and enable better offline experience."}),"\n",(0,r.jsx)(n.li,{children:"Lazily loading routes and assets that aren\u2019t requested as frequently."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"performance-best-practice",children:"Performance Best Practice"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Code optimization:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Fast CSS styles: ",(0,r.jsx)(n.code,{children:"CSS Performance"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Fast JavaScript code (",(0,r.jsx)(n.code,{children:"Effective JavaScript"}),"):","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"DOM performance."}),"\n",(0,r.jsx)(n.li,{children:"React performance."}),"\n",(0,r.jsx)(n.li,{children:"Concurrency: asynchronous/web worker."}),"\n",(0,r.jsx)(n.li,{children:"Use monomorphic objects due to shape and inline caches."}),"\n",(0,r.jsx)(n.li,{children:"Use monomorphic function in hot code paths."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Resources optimization (HTML/CSS/JS/Images/Audio/Video/Fonts):","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Remove useless files: Chrome devtool code coverage panel."}),"\n",(0,r.jsxs)(n.li,{children:["Code splitting: Webpack ",(0,r.jsx)(n.code,{children:"splitChunks"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"Tree shaking."}),"\n",(0,r.jsxs)(n.li,{children:["Gzip/Brotli (",(0,r.jsx)(n.code,{children:"Accept-Encoding"}),"/",(0,r.jsx)(n.code,{children:"Content-Encoding"}),")."]}),"\n",(0,r.jsx)(n.li,{children:"CDN: faster resources."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Loading performance:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"PreFetch/PreLoad/PreRendering (SSR)."}),"\n",(0,r.jsx)(n.li,{children:"Lazy loading: HTML/CSS/JS/Images/Audio/Video/Fonts."}),"\n",(0,r.jsx)(n.li,{children:"Resources priority hints."}),"\n",(0,r.jsx)(n.li,{children:"Resources loading hints."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Web caching:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Offline caching: PWA."}),"\n",(0,r.jsx)(n.li,{children:"HTTP caching: \u5f3a\u7f13\u5b58\u4e0e\u534f\u5546\u7f13\u5b58."}),"\n",(0,r.jsx)(n.li,{children:"CDN: shared public caches."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Network protocols performance:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Reducing HTTP requests.","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u91cd\u7528 TCP \u8fde\u63a5."}),"\n",(0,r.jsx)(n.li,{children:"\u591a\u8def\u590d\u7528."}),"\n",(0,r.jsx)(n.li,{children:"\u51cf\u5c11\u4f20\u8f93\u5197\u4f59\u8d44\u6e90."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Caching and reducing DNS lookups:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Remove too much domains."}),"\n",(0,r.jsx)(n.li,{children:"HTML5 DNS prefetch."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"Avoid HTTP redirects."}),"\n",(0,r.jsx)(n.li,{children:"CDN: minimize RTT."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"performance-tools",children:"Performance Tools"}),"\n",(0,r.jsxs)(n.p,{children:["Speed tools ",(0,r.jsx)(n.a,{href:"https://web.dev/speed-tools",children:"list"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.webpagetest.org",children:"WebPageTest"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://pagespeed.web.dev",children:"PageSpeed Insights"})}),"\n",(0,r.jsxs)(n.li,{children:["Chrome UX ",(0,r.jsx)(n.a,{href:"https://developer.chrome.com/docs/crux",children:"report"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Chrome ",(0,r.jsx)(n.a,{href:"https://developer.chrome.com/docs/devtools",children:"DevTools"})]}),"\n",(0,r.jsxs)(n.li,{children:["LightHouse CI ",(0,r.jsx)(n.a,{href:"https://github.com/treosh/lighthouse-ci-action",children:"action"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Chrome audit ",(0,r.jsx)(n.a,{href:"https://github.com/GoogleChrome/lighthouse",children:"tab"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Performance ",(0,r.jsx)(n.a,{href:"https://web.dev/lighthouse-performance",children:"audit"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["PWA ",(0,r.jsx)(n.a,{href:"https://web.dev/lighthouse-pwa",children:"audit"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Best practices ",(0,r.jsx)(n.a,{href:"https://web.dev/lighthouse-best-practices",children:"audit"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Accessibility ",(0,r.jsx)(n.a,{href:"https://web.dev/lighthouse-accessibility",children:"audit"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["SEO ",(0,r.jsx)(n.a,{href:"https://web.dev/lighthouse-seo",children:"audit"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Chrome inspector: ",(0,r.jsx)(n.code,{children:"chrome://inspect/#devices"})," to start inspecting."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"performance-reference",children:"Performance Reference"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"web.dev"})," performance optimization ",(0,r.jsx)(n.a,{href:"https://web.dev/explore/fast",children:"guide"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"web.dev"})," performance newbie ",(0,r.jsx)(n.a,{href:"https://web.dev/learn/performance",children:"course"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Performance ",(0,r.jsx)(n.a,{href:"https://www.speedcurve.com/blog/performance-budgets",children:"budgets"}),"."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},8088:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/BrowserCache-9f55f887f8967310eccaf7c05abed941.webp"},4605:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/CacheControl-bbaa18976491e5a7d096667fbf6be72c.webp"},1428:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/CriticalRenderPath-d8b8799786c63f7b716d6d1fec65e916.svg"},9940:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/HTTPCache-392c580ce12949cd9918ed591172e6ef.webp"},9754:(e,n,i)=>{i.d(n,{A:()=>s});const s="data:image/webp;base64,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"},3005:(e,n,i)=>{i.d(n,{A:()=>s});const s="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA4MjAgMjAwIj48c3R5bGU+LnN2Zy1sYWJlbCwuc3ZnLXRhZ3tkb21pbmFudC1iYXNlbGluZTpjZW50cmFsfS5zdmctdGFne2ZvbnQtd2VpZ2h0OjcwMDtmb250LWZhbWlseTptb25vc3BhY2U7Zm9udC1zaXplOjEzcHh9LnN2Zy1sYWJlbHtmb250LWZhbWlseTpzYW5zLXNlcmlmO2ZvbnQtc2l6ZToxMHB4fS5wYXJzZXJ7c3Ryb2tlOiM2ZWFlMDA7ZmlsbDojNmVhZTAwfS5mZXRjaHtzdHJva2U6IzAwMzVmZjtmaWxsOiMwMDM1ZmZ9LmV4ZWN1dGlvbntzdHJva2U6cmVkO2ZpbGw6cmVkfS5wcm9ncmVzc3tzdHJva2Utd2lkdGg6Mn0ucHJvZ3Jlc3MucGFyc2VyOm5vdCguZmlyc3Qpe21hcmtlci1zdGFydDp1cmwoI3BhcnNlci1tYXJrZXIpfS5wcm9ncmVzcy5wYXJzZXI6bm90KC5sYXN0KXttYXJrZXItZW5kOnVybCgjcGFyc2VyLW1hcmtlcil9LnByb2dyZXNzLmZldGNoOm5vdCguZmlyc3Qpe21hcmtlci1zdGFydDp1cmwoI2ZldGNoLW1hcmtlcil9LnByb2dyZXNzLmZldGNoOm5vdCgubGFzdCl7bWFya2VyLWVuZDp1cmwoI2ZldGNoLW1hcmtlcil9LnByb2dyZXNzLmV4ZWN1dGlvbjpub3QoLmZpcnN0KXttYXJrZXItc3RhcnQ6dXJsKCNleGVjdXRpb24tbWFya2VyKX0ucHJvZ3Jlc3MuZXhlY3V0aW9uOm5vdCgubGFzdCl7bWFya2VyLWVuZDp1cmwoI2V4ZWN1dGlvbi1tYXJrZXIpfW1hcmtlciZndDtjaXJjbGV7c3Ryb2tlLXdpZHRoOjB9LmNvbm5lY3RvcntzdHJva2U6I2NlY2VjZTtzdHJva2Utd2lkdGg6MX08L3N0eWxlPjxwYXRoIHN0cm9rZT0iIzZhOTQwMCIgc3Ryb2tlLWRhc2hhcnJheT0iMSAxIiBkPSJNMCAzMy41aDgyME0wIDY2LjVoODIwTTAgOTkuNWg4MjBtLTgyMCAzM2g4MjBNMjQ1LjUgMXYyOG0wIDl2MjRtMCA2djI3bTAgOXYyNG0wIDl2MjgiLz48ZGVmcz48bWFya2VyIGlkPSJwYXJzZXItbWFya2VyIiBtYXJrZXJIZWlnaHQ9IjMiIG1hcmtlcldpZHRoPSIzIiByZWZYPSIxLjUiIHJlZlk9IjEuNSI+PGNpcmNsZSBjeD0iMS41IiBjeT0iMS41IiByPSIxLjUiIGNsYXNzPSJwYXJzZXIiLz48L21hcmtlcj48bWFya2VyIGlkPSJmZXRjaC1tYXJrZXIiIG1hcmtlckhlaWdodD0iMyIgbWFya2VyV2lkdGg9IjMiIHJlZlg9IjEuNSIgcmVmWT0iMS41Ij48Y2lyY2xlIGN4PSIxLjUiIGN5PSIxLjUiIHI9IjEuNSIgY2xhc3M9ImZldGNoIi8+PC9tYXJrZXI+PG1hcmtlciBpZD0iZXhlY3V0aW9uLW1hcmtlciIgbWFya2VySGVpZ2h0PSIzIiBtYXJrZXJXaWR0aD0iMyIgcmVmWD0iMS41IiByZWZZPSIxLjUiPjxjaXJjbGUgY3g9IjEuNSIgY3k9IjEuNSIgcj0iMS41IiBjbGFzcz0iZXhlY3V0aW9uIi8+PC9tYXJrZXI+PC9kZWZzPjx0ZXh0IHg9IjEyIiB5PSIxNi43NSIgY2xhc3M9InN2Zy10YWciPiZsdDtzY3JpcHQmZ3Q7PC90ZXh0Pjx0ZXh0IHk9IjkiIGNsYXNzPSJzdmctbGFiZWwiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI1MikiPlNjcmlwdGluZzo8L3RleHQ+PHRleHQgeT0iMjQiIGNsYXNzPSJzdmctbGFiZWwiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI1MikiPkhUTUwgUGFyc2VyOjwvdGV4dD48cGF0aCBkPSJNNTA5IDl2MTVNNjU2IDl2MTUiIGNsYXNzPSJjb25uZWN0b3IiLz48cGF0aCBkPSJNMzU4IDI0aDE1MSIgY2xhc3M9InBhcnNlciBwcm9ncmVzcyBmaXJzdCIvPjxwYXRoIGQ9Ik01MDkgOWg5NyIgY2xhc3M9ImZldGNoIHByb2dyZXNzIi8+PHBhdGggZD0iTTYwNiA5aDUwIiBjbGFzcz0iZXhlY3V0aW9uIHByb2dyZXNzIi8+PHBhdGggZD0iTTY1NiAyNGgxMjgiIGNsYXNzPSJwYXJzZXIgcHJvZ3Jlc3MgbGFzdCIvPjx0ZXh0IHg9IjEyIiB5PSIxNi43NSIgY2xhc3M9InN2Zy10YWciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAgMzMpIj4mbHQ7c2NyaXB0IGRlZmVyJmd0OzwvdGV4dD48dGV4dCB5PSI5IiBjbGFzcz0ic3ZnLWxhYmVsIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNTIgMzMpIj5TY3JpcHRpbmc6PC90ZXh0Pjx0ZXh0IHk9IjI0IiBjbGFzcz0ic3ZnLWxhYmVsIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNTIgMzMpIj5IVE1MIFBhcnNlcjo8L3RleHQ+PHBhdGggZD0iTTczNiA0MnYxNSIgY2xhc3M9ImNvbm5lY3RvciIvPjxwYXRoIGQ9Ik0zNTggNTdoMzc4IiBjbGFzcz0icGFyc2VyIHByb2dyZXNzIGZpcnN0Ii8+PHBhdGggZD0iTTUwOSA0Mmg5NyIgY2xhc3M9ImZldGNoIHByb2dyZXNzIi8+PHBhdGggZD0iTTczNiA0Mmg0OCIgY2xhc3M9ImV4ZWN1dGlvbiBwcm9ncmVzcyBsYXN0Ii8+PGc+PHRleHQgeD0iMTIiIHk9IjE2Ljc1IiBjbGFzcz0ic3ZnLXRhZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCA2NikiPiZsdDtzY3JpcHQgYXN5bmMmZ3Q7PC90ZXh0Pjx0ZXh0IHk9IjkiIGNsYXNzPSJzdmctbGFiZWwiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI1MiA2NikiPlNjcmlwdGluZzo8L3RleHQ+PHRleHQgeT0iMjQiIGNsYXNzPSJzdmctbGFiZWwiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI1MiA2NikiPkhUTUwgUGFyc2VyOjwvdGV4dD48cGF0aCBkPSJNNjA2IDc1djE1bTUwLTE1djE1IiBjbGFzcz0iY29ubmVjdG9yIi8+PHBhdGggZD0iTTM1OCA5MGgyNDgiIGNsYXNzPSJwYXJzZXIgcHJvZ3Jlc3MgZmlyc3QiLz48cGF0aCBkPSJNNTA5IDc1aDk3IiBjbGFzcz0iZmV0Y2ggcHJvZ3Jlc3MiLz48cGF0aCBkPSJNNjA2IDc1aDUwIiBjbGFzcz0iZXhlY3V0aW9uIHByb2dyZXNzIi8+PHBhdGggZD0iTTY1NiA5MGgxMjgiIGNsYXNzPSJwYXJzZXIgcHJvZ3Jlc3MgbGFzdCIvPjwvZz48Zz48dGV4dCB4PSIxMiIgeT0iMTYuNzUiIGNsYXNzPSJzdmctdGFnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIDk5KSI+Jmx0O3NjcmlwdCB0eXBlPSZxdW90O21vZHVsZSZxdW90OyZndDs8L3RleHQ+PHRleHQgeT0iOSIgY2xhc3M9InN2Zy1sYWJlbCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjUyIDk5KSI+U2NyaXB0aW5nOjwvdGV4dD48dGV4dCB5PSIyNCIgY2xhc3M9InN2Zy1sYWJlbCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjUyIDk5KSI+SFRNTCBQYXJzZXI6PC90ZXh0PjxwYXRoIGQ9Ik03MzYgMTA4djE1IiBjbGFzcz0iY29ubmVjdG9yIi8+PHBhdGggZD0iTTM1OCAxMjNoMzc4IiBjbGFzcz0icGFyc2VyIHByb2dyZXNzIGZpcnN0Ii8+PHBhdGggZD0iTTUwOSAxMDhoOTdtMCAwaDIwbS0yMCAwbDIwIDcuNW0wIDBoMjBtMCAwaDIwbS0yMCAwbDIwLTcuNSIgY2xhc3M9ImZldGNoIHByb2dyZXNzIi8+PHBhdGggZD0iTTczNiAxMDhoNDgiIGNsYXNzPSJleGVjdXRpb24gcHJvZ3Jlc3MgbGFzdCIvPjwvZz48Zz48dGV4dCB4PSIxMiIgeT0iMTYuNzUiIGNsYXNzPSJzdmctdGFnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIDEzMikiPiZsdDtzY3JpcHQgdHlwZT0mcXVvdDttb2R1bGUmcXVvdDsgYXN5bmMmZ3Q7PC90ZXh0Pjx0ZXh0IHk9IjkiIGNsYXNzPSJzdmctbGFiZWwiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI1MiAxMzIpIj5TY3JpcHRpbmc6PC90ZXh0Pjx0ZXh0IHk9IjI0IiBjbGFzcz0ic3ZnLWxhYmVsIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNTIgMTMyKSI+SFRNTCBQYXJzZXI6PC90ZXh0PjxwYXRoIGQ9Ik02NjYgMTQxdjE1bTUwLTE1djE1IiBjbGFzcz0iY29ubmVjdG9yIi8+PHBhdGggZD0iTTM1OCAxNTZoMzA4IiBjbGFzcz0icGFyc2VyIHByb2dyZXNzIGZpcnN0Ii8+PHBhdGggZD0iTTUwOSAxNDFoOTdtMCAwaDIwbS0yMCAwbDIwIDcuNW0wIDBoMjBtMCAwaDIwbS0yMCAwbDIwLTcuNSIgY2xhc3M9ImZldGNoIHByb2dyZXNzIi8+PHBhdGggZD0iTTY2NiAxNDFoNTAiIGNsYXNzPSJleGVjdXRpb24gcHJvZ3Jlc3MiLz48cGF0aCBkPSJNNzE2IDE1Nmg2OCIgY2xhc3M9InBhcnNlciBwcm9ncmVzcyBsYXN0Ii8+PC9nPjxnIGNsYXNzPSJsZWdlbmQiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDM1Ny41IDE3MikiPjxjaXJjbGUgY3g9IjMiIGN5PSIzIiByPSIzIiBjbGFzcz0icGFyc2VyIi8+PHRleHQgeD0iOSIgeT0iMyIgY2xhc3M9InN2Zy1sYWJlbCI+cGFyc2VyPC90ZXh0PjxjaXJjbGUgY3g9IjUwIiBjeT0iMyIgcj0iMyIgY2xhc3M9ImZldGNoIi8+PHRleHQgeD0iNTYiIHk9IjMiIGNsYXNzPSJzdmctbGFiZWwiPmZldGNoPC90ZXh0PjxjaXJjbGUgY3g9IjkwIiBjeT0iMyIgcj0iMyIgY2xhc3M9ImV4ZWN1dGlvbiIvPjx0ZXh0IHg9Ijk2IiB5PSIzIiBjbGFzcz0ic3ZnLWxhYmVsIj5leGVjdXRpb248L3RleHQ+PC9nPjx0ZXh0IHg9Ijc4MiIgeT0iMTc1IiBjbGFzcz0ic3ZnLWxhYmVsIiB0ZXh0LWFuY2hvcj0iZW5kIj5ydW50aW1lIOKGkjwvdGV4dD48L3N2Zz4="},842:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>c});var s=i(8101);const r={},t=s.createContext(r);function l(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);